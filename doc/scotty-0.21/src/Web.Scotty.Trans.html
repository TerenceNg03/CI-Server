<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, RankNTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# language LambdaCase #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | It should be noted that most of the code snippets below depend on the</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- OverloadedStrings language pragma.</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- The functions in this module allow an arbitrary monad to be embedded</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- in Scotty's monad transformer stack, e.g. for complex endpoint configuration,</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- interacting with databases etc.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Scotty is set up by default for development mode. For production servers,</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- you will likely want to modify 'settings' and the 'defaultHandler'. See</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- the comments on each of these functions for more information.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Please refer to the @examples@ directory and the @spec@ test suite for concrete use cases, e.g. constructing responses, exception handling and useful implementation details.</span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Web.Scotty.Trans</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Running 'scotty' servers</span></span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><a href="Web.Scotty.Trans.html#scottyT"><span class="hs-identifier">scottyT</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.html#scottyOptsT"><span class="hs-identifier">scottyOptsT</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.html#scottySocketT"><span class="hs-identifier">scottySocketT</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Options"><span class="hs-identifier">Options</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#defaultOptions"><span class="hs-identifier">defaultOptions</span></a></span><span>
</span><span id="line-21"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** scotty-to-WAI</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.html#scottyAppT"><span class="hs-identifier">scottyAppT</span></a></span><span>
</span><span id="line-23"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Defining Middleware and Routes</span></span><span>
</span><span id="line-24"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span>      </span><span class="hs-comment">-- | 'Middleware' and routes are run in the order in which they</span><span>
</span><span id="line-26"></span><span>      </span><span class="hs-comment">-- are defined. All middleware is run first, followed by the first</span><span>
</span><span id="line-27"></span><span>      </span><span class="hs-comment">-- route that matches. If no route matches, a 404 response is given.</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.html#middleware"><span class="hs-identifier">middleware</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#get"><span class="hs-identifier">get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#post"><span class="hs-identifier">post</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#put"><span class="hs-identifier">put</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#delete"><span class="hs-identifier">delete</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#patch"><span class="hs-identifier">patch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#options"><span class="hs-identifier">options</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#addroute"><span class="hs-identifier">addroute</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#matchAny"><span class="hs-identifier">matchAny</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#notFound"><span class="hs-identifier">notFound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.html#setMaxRequestBodySize"><span class="hs-identifier">setMaxRequestBodySize</span></a></span><span>
</span><span id="line-29"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Route Patterns</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#capture"><span class="hs-identifier">capture</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#regex"><span class="hs-identifier">regex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#function"><span class="hs-identifier">function</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html#literal"><span class="hs-identifier">literal</span></a></span><span>
</span><span id="line-31"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Accessing the Request and its fields</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#request"><span class="hs-identifier">request</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.Lazy.html#header"><span class="hs-identifier">Lazy.header</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.Lazy.html#headers"><span class="hs-identifier">Lazy.headers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#body"><span class="hs-identifier">body</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#bodyReader"><span class="hs-identifier">bodyReader</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#jsonData"><span class="hs-identifier">jsonData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#files"><span class="hs-identifier">files</span></a></span><span>
</span><span id="line-34"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Accessing Path, Form and Query Parameters</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#param"><span class="hs-identifier">param</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#params"><span class="hs-identifier">params</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#pathParam"><span class="hs-identifier">pathParam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#captureParam"><span class="hs-identifier">captureParam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#formParam"><span class="hs-identifier">formParam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#queryParam"><span class="hs-identifier">queryParam</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#pathParamMaybe"><span class="hs-identifier">pathParamMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#captureParamMaybe"><span class="hs-identifier">captureParamMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#formParamMaybe"><span class="hs-identifier">formParamMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#queryParamMaybe"><span class="hs-identifier">queryParamMaybe</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#pathParams"><span class="hs-identifier">pathParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#captureParams"><span class="hs-identifier">captureParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#formParams"><span class="hs-identifier">formParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#queryParams"><span class="hs-identifier">queryParams</span></a></span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Modifying the Response and Redirecting</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#status"><span class="hs-identifier">status</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.Lazy.html#addHeader"><span class="hs-identifier">Lazy.addHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.Lazy.html#setHeader"><span class="hs-identifier">Lazy.setHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.Lazy.html#redirect"><span class="hs-identifier">Lazy.redirect</span></a></span><span>
</span><span id="line-41"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Setting Response Body</span></span><span>
</span><span id="line-42"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span>      </span><span class="hs-comment">-- | Note: only one of these should be present in any given route</span><span>
</span><span id="line-44"></span><span>      </span><span class="hs-comment">-- definition, as they completely replace the current 'Response' body.</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.Lazy.html#text"><span class="hs-identifier">Lazy.text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.Lazy.html#html"><span class="hs-identifier">Lazy.html</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#file"><span class="hs-identifier">file</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#json"><span class="hs-identifier">json</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#stream"><span class="hs-identifier">stream</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#raw"><span class="hs-identifier">raw</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#nested"><span class="hs-identifier">nested</span></a></span><span>
</span><span id="line-46"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Accessing the fields of the Response</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#getResponseHeaders"><span class="hs-identifier">getResponseHeaders</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#getResponseStatus"><span class="hs-identifier">getResponseStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#getResponseContent"><span class="hs-identifier">getResponseContent</span></a></span><span>
</span><span id="line-48"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Exceptions</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.Lazy.html#raise"><span class="hs-identifier">Lazy.raise</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.Lazy.html#raiseStatus"><span class="hs-identifier">Lazy.raiseStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#throw"><span class="hs-identifier">throw</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#rescue"><span class="hs-identifier">rescue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#next"><span class="hs-identifier">next</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#finish"><span class="hs-identifier">finish</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.html#defaultHandler"><span class="hs-identifier">defaultHandler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#liftAndCatchIO"><span class="hs-identifier">liftAndCatchIO</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#StatusError"><span class="hs-identifier">StatusError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyException"><span class="hs-identifier">ScottyException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Parsing Parameters</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Param"><span class="hs-identifier">Param</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#Parsable"><span class="hs-identifier">Parsable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html#readEither"><span class="hs-identifier">readEither</span></a></span><span>
</span><span id="line-55"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#RoutePattern"><span class="hs-identifier">RoutePattern</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#File"><span class="hs-identifier">File</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Content"><span class="hs-identifier">Content</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Kilobytes"><span class="hs-identifier">Kilobytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ErrorHandler"><span class="hs-identifier">ErrorHandler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Handler</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Monad Transformers</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier">ScottyT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ActionT"><span class="hs-identifier">ActionT</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyState"><span class="hs-identifier">ScottyState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#defaultScottyState"><span class="hs-identifier">defaultScottyState</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Blaze.ByteString.Builder</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Blaze.ByteString.Builder.Char8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromString</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">assert</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">execState</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">status404</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">status413</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">status500</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.Socket</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Socket</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.Wai</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Application</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Middleware</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Response</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">responseBuilder</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.Wai.Handler.Warp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Port</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runSettings</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runSettingsSocket</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setPort</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getPort</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Web.Scotty.Action.html"><span class="hs-identifier">Web.Scotty.Action</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Web.Scotty.Route.html"><span class="hs-identifier">Web.Scotty.Route</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html"><span class="hs-identifier">Web.Scotty.Internal.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier">ScottyT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#defaultScottyState"><span class="hs-identifier">defaultScottyState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Application"><span class="hs-identifier">Application</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#RoutePattern"><span class="hs-identifier">RoutePattern</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Options"><span class="hs-identifier">Options</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#defaultOptions"><span class="hs-identifier">defaultOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#RouteOptions"><span class="hs-identifier">RouteOptions</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#defaultRouteOptions"><span class="hs-identifier">defaultRouteOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ErrorHandler"><span class="hs-identifier">ErrorHandler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Kilobytes"><span class="hs-identifier">Kilobytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#File"><span class="hs-identifier">File</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#addMiddleware"><span class="hs-identifier">addMiddleware</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#setHandler"><span class="hs-identifier">setHandler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#updateMaxRequestBodySize"><span class="hs-identifier">updateMaxRequestBodySize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#routes"><span class="hs-identifier">routes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#middlewares"><span class="hs-identifier">middlewares</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyException"><span class="hs-identifier">ScottyException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyState"><span class="hs-identifier">ScottyState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#defaultScottyState"><span class="hs-identifier">defaultScottyState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#StatusError"><span class="hs-identifier">StatusError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Content"><span class="hs-identifier">Content</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Web.Scotty.Trans.Lazy.html"><span class="hs-identifier">Web.Scotty.Trans.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Web.Scotty.Util.html"><span class="hs-identifier">Web.Scotty.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Util.html#socketDescription"><span class="hs-identifier">socketDescription</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Web.Scotty.Body.html"><span class="hs-identifier">Web.Scotty.Body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Body.html#newBodyInfo"><span class="hs-identifier">newBodyInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">UnliftIO.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Handler</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Run a scotty application using the warp server.</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- NB: scotty p === scottyT p id</span><span>
</span><span id="line-87"></span><span id="local-6989586621679122461"><span id="local-6989586621679122462"><span class="annot"><a href="Web.Scotty.Trans.html#scottyT"><span class="hs-identifier hs-type">scottyT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679122461"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679122462"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Port</span></span><span>
</span><span id="line-89"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122461"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Response</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Response</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Run monad 'm' into 'IO', called at each action.</span></span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier hs-type">ScottyT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122461"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122462"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-92"></span><span id="scottyT"><span class="annot"><span class="annottext">scottyT :: forall (m :: * -&gt; *) (n :: * -&gt; *).
(Monad m, MonadIO n) =&gt;
Port -&gt; (m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n ()
</span><a href="Web.Scotty.Trans.html#scottyT"><span class="hs-identifier hs-var hs-var">scottyT</span></a></span></span><span> </span><span id="local-6989586621679122675"><span class="annot"><span class="annottext">Port
</span><a href="#local-6989586621679122675"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; (m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n ()
forall (m :: * -&gt; *) (n :: * -&gt; *).
(Monad m, MonadIO n) =&gt;
Options -&gt; (m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n ()
</span><a href="Web.Scotty.Trans.html#scottyOptsT"><span class="hs-identifier hs-var">scottyOptsT</span></a></span><span> </span><span class="annot"><span class="annottext">(Options -&gt; (m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n ())
-&gt; Options -&gt; (m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Web.Scotty.Internal.Types.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#settings"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">setPort</span></span><span> </span><span class="annot"><a href="#local-6989586621679122675"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Scotty.Internal.Types.html#settings"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#defaultOptions"><span class="hs-identifier hs-type">defaultOptions</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- | Run a scotty application using the warp server, passing extra options.</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- NB: scottyOpts opts === scottyOptsT opts id</span><span>
</span><span id="line-96"></span><span id="local-6989586621679122470"><span id="local-6989586621679122471"><span class="annot"><a href="Web.Scotty.Trans.html#scottyOptsT"><span class="hs-identifier hs-type">scottyOptsT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679122470"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679122471"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span>
</span><span id="line-98"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122470"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Response</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Response</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Run monad 'm' into 'IO', called at each action.</span></span><span>
</span><span id="line-99"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier hs-type">ScottyT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122470"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122471"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-101"></span><span id="scottyOptsT"><span class="annot"><span class="annottext">scottyOptsT :: forall (m :: * -&gt; *) (n :: * -&gt; *).
(Monad m, MonadIO n) =&gt;
Options -&gt; (m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n ()
</span><a href="Web.Scotty.Trans.html#scottyOptsT"><span class="hs-identifier hs-var hs-var">scottyOptsT</span></a></span></span><span> </span><span id="local-6989586621679122699"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679122699"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679122700"><span class="annot"><span class="annottext">m Response -&gt; IO Response
</span><a href="#local-6989586621679122700"><span class="hs-identifier hs-var">runActionToIO</span></a></span></span><span> </span><span id="local-6989586621679122701"><span class="annot"><span class="annottext">ScottyT m ()
</span><a href="#local-6989586621679122701"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; n () -&gt; n ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Options -&gt; Port
</span><a href="Web.Scotty.Internal.Types.html#verbose"><span class="hs-identifier hs-var">verbose</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679122699"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Port -&gt; Port -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Port
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(n () -&gt; n ()) -&gt; n () -&gt; n ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; n ()
forall a. IO a -&gt; n a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; n ()) -&gt; IO () -&gt; n ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Setting phasers to stun... (port &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Port -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Settings -&gt; Port
</span><span class="hs-identifier hs-var">getPort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Options -&gt; Settings
</span><a href="Web.Scotty.Internal.Types.html#settings"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679122699"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;) (ctrl-c to quit)&quot;</span></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; n ()
forall a. IO a -&gt; n a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; n ()) -&gt; (Application -&gt; IO ()) -&gt; Application -&gt; n ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Settings -&gt; Application -&gt; IO ()
</span><span class="hs-identifier hs-var">runSettings</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Options -&gt; Settings
</span><a href="Web.Scotty.Internal.Types.html#settings"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679122699"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Application -&gt; n ()) -&gt; n Application -&gt; n ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n Application
forall (m :: * -&gt; *) (n :: * -&gt; *).
(Monad m, Monad n) =&gt;
(m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n Application
</span><a href="Web.Scotty.Trans.html#scottyAppT"><span class="hs-identifier hs-var">scottyAppT</span></a></span><span> </span><span class="annot"><span class="annottext">m Response -&gt; IO Response
</span><a href="#local-6989586621679122700"><span class="hs-identifier hs-var">runActionToIO</span></a></span><span> </span><span class="annot"><span class="annottext">ScottyT m ()
</span><a href="#local-6989586621679122701"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | Run a scotty application using the warp server, passing extra options, and</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- listening on the provided socket.</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- NB: scottySocket opts sock === scottySocketT opts sock id</span><span>
</span><span id="line-109"></span><span id="local-6989586621679122498"><span id="local-6989586621679122499"><span class="annot"><a href="Web.Scotty.Trans.html#scottySocketT"><span class="hs-identifier hs-type">scottySocketT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679122498"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679122499"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span>
</span><span id="line-111"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Socket</span></span><span>
</span><span id="line-112"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122498"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Response</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Response</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier hs-type">ScottyT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122498"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122499"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-115"></span><span id="scottySocketT"><span class="annot"><span class="annottext">scottySocketT :: forall (m :: * -&gt; *) (n :: * -&gt; *).
(Monad m, MonadIO n) =&gt;
Options
-&gt; Socket -&gt; (m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n ()
</span><a href="Web.Scotty.Trans.html#scottySocketT"><span class="hs-identifier hs-var hs-var">scottySocketT</span></a></span></span><span> </span><span id="local-6989586621679122726"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679122726"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679122727"><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679122727"><span class="hs-identifier hs-var">sock</span></a></span></span><span> </span><span id="local-6989586621679122728"><span class="annot"><span class="annottext">m Response -&gt; IO Response
</span><a href="#local-6989586621679122728"><span class="hs-identifier hs-var">runActionToIO</span></a></span></span><span> </span><span id="local-6989586621679122729"><span class="annot"><span class="annottext">ScottyT m ()
</span><a href="#local-6989586621679122729"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; n () -&gt; n ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Options -&gt; Port
</span><a href="Web.Scotty.Internal.Types.html#verbose"><span class="hs-identifier hs-var">verbose</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679122726"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Port -&gt; Port -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Port
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(n () -&gt; n ()) -&gt; n () -&gt; n ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-117"></span><span>        </span><span id="local-6989586621679122730"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679122730"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Char] -&gt; n [Char]
forall a. IO a -&gt; n a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO [Char] -&gt; n [Char]) -&gt; IO [Char] -&gt; n [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Socket -&gt; IO [Char]
</span><a href="Web.Scotty.Util.html#socketDescription"><span class="hs-identifier hs-var">socketDescription</span></a></span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679122727"><span class="hs-identifier hs-var">sock</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; n ()
forall a. IO a -&gt; n a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; n ()) -&gt; IO () -&gt; n ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Setting phasers to stun... (&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679122730"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;) (ctrl-c to quit)&quot;</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; n ()
forall a. IO a -&gt; n a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; n ()) -&gt; (Application -&gt; IO ()) -&gt; Application -&gt; n ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Settings -&gt; Socket -&gt; Application -&gt; IO ()
</span><span class="hs-identifier hs-var">runSettingsSocket</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Options -&gt; Settings
</span><a href="Web.Scotty.Internal.Types.html#settings"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679122726"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679122727"><span class="hs-identifier hs-var">sock</span></a></span><span> </span><span class="annot"><span class="annottext">(Application -&gt; n ()) -&gt; n Application -&gt; n ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n Application
forall (m :: * -&gt; *) (n :: * -&gt; *).
(Monad m, Monad n) =&gt;
(m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n Application
</span><a href="Web.Scotty.Trans.html#scottyAppT"><span class="hs-identifier hs-var">scottyAppT</span></a></span><span> </span><span class="annot"><span class="annottext">m Response -&gt; IO Response
</span><a href="#local-6989586621679122728"><span class="hs-identifier hs-var">runActionToIO</span></a></span><span> </span><span class="annot"><span class="annottext">ScottyT m ()
</span><a href="#local-6989586621679122729"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Turn a scotty application into a WAI 'Application', which can be</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- run with any WAI handler.</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- NB: scottyApp === scottyAppT id</span><span>
</span><span id="line-124"></span><span id="local-6989586621679122496"><span id="local-6989586621679122497"><span class="annot"><a href="Web.Scotty.Trans.html#scottyAppT"><span class="hs-identifier hs-type">scottyAppT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679122496"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679122497"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122496"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Response</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Response</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Run monad 'm' into 'IO', called at each action.</span></span><span>
</span><span id="line-126"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier hs-type">ScottyT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122496"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122497"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Application</span></span></span></span><span>
</span><span id="line-128"></span><span id="scottyAppT"><span class="annot"><span class="annottext">scottyAppT :: forall (m :: * -&gt; *) (n :: * -&gt; *).
(Monad m, Monad n) =&gt;
(m Response -&gt; IO Response) -&gt; ScottyT m () -&gt; n Application
</span><a href="Web.Scotty.Trans.html#scottyAppT"><span class="hs-identifier hs-var hs-var">scottyAppT</span></a></span></span><span> </span><span id="local-6989586621679122739"><span class="annot"><span class="annottext">m Response -&gt; IO Response
</span><a href="#local-6989586621679122739"><span class="hs-identifier hs-var">runActionToIO</span></a></span></span><span> </span><span id="local-6989586621679122740"><span class="annot"><span class="annottext">ScottyT m ()
</span><a href="#local-6989586621679122740"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679122741"><span class="annot"><span class="annottext">s :: ScottyState m
</span><a href="#local-6989586621679122741"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (ScottyState m) () -&gt; ScottyState m -&gt; ScottyState m
forall s a. State s a -&gt; s -&gt; s
</span><span class="hs-identifier hs-var">execState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScottyT m () -&gt; State (ScottyState m) ()
forall (m :: * -&gt; *) a. ScottyT m a -&gt; State (ScottyState m) a
</span><a href="Web.Scotty.Internal.Types.html#runS"><span class="hs-identifier hs-var">runS</span></a></span><span> </span><span class="annot"><span class="annottext">ScottyT m ()
</span><a href="#local-6989586621679122740"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ScottyState m
forall (m :: * -&gt; *). ScottyState m
</span><a href="Web.Scotty.Internal.Types.html#defaultScottyState"><span class="hs-identifier hs-var">defaultScottyState</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679122757"><span class="annot"><span class="annottext">rapp :: Request -&gt; (Response -&gt; IO b) -&gt; IO b
</span><a href="#local-6989586621679122757"><span class="hs-identifier hs-var hs-var">rapp</span></a></span></span><span> </span><span id="local-6989586621679122758"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679122758"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621679122759"><span class="annot"><span class="annottext">Response -&gt; IO b
</span><a href="#local-6989586621679122759"><span class="hs-identifier hs-var">callback</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-131"></span><span>          </span><span id="local-6989586621679122760"><span class="annot"><span class="annottext">BodyInfo
</span><a href="#local-6989586621679122760"><span class="hs-identifier hs-var">bodyInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Request -&gt; IO BodyInfo
forall (m :: * -&gt; *). MonadIO m =&gt; Request -&gt; m BodyInfo
</span><a href="Web.Scotty.Body.html#newBodyInfo"><span class="hs-identifier hs-var">newBodyInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679122758"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-132"></span><span>          </span><span id="local-6989586621679122761"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679122761"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Response -&gt; IO Response
</span><a href="#local-6989586621679122739"><span class="hs-identifier hs-var">runActionToIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Request -&gt; m Response)
-&gt; [(Request -&gt; m Response) -&gt; Request -&gt; m Response]
-&gt; Request
-&gt; m Response
forall (t :: * -&gt; *) a. Foldable t =&gt; a -&gt; t (a -&gt; a) -&gt; a
</span><a href="Web.Scotty.Trans.html#applyAll"><span class="hs-identifier hs-var">applyAll</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; m Response
forall (m :: * -&gt; *). Monad m =&gt; Application m
</span><a href="Web.Scotty.Trans.html#notFoundApp"><span class="hs-identifier hs-var">notFoundApp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">BodyInfo -&gt; (Request -&gt; m Response) -&gt; Request -&gt; m Response
</span><a href="#local-6989586621679122764"><span class="hs-identifier hs-var">midd</span></a></span><span> </span><span class="annot"><span class="annottext">BodyInfo
</span><a href="#local-6989586621679122760"><span class="hs-identifier hs-var">bodyInfo</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679122764"><span class="annot"><span class="annottext">BodyInfo -&gt; (Request -&gt; m Response) -&gt; Request -&gt; m Response
</span><a href="#local-6989586621679122764"><span class="hs-identifier hs-var">midd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ScottyState m
-&gt; [BodyInfo -&gt; (Request -&gt; m Response) -&gt; Request -&gt; m Response]
forall (m :: * -&gt; *). ScottyState m -&gt; [BodyInfo -&gt; Middleware m]
</span><a href="Web.Scotty.Internal.Types.html#routes"><span class="hs-identifier hs-var">routes</span></a></span><span> </span><span class="annot"><span class="annottext">ScottyState m
</span><a href="#local-6989586621679122741"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679122758"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>            </span><span class="annot"><span class="annottext">IO Response -&gt; (ScottyException -&gt; IO Response) -&gt; IO Response
forall (m :: * -&gt; *) e a.
(MonadUnliftIO m, Exception e) =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><span class="hs-operator hs-var">`catch`</span></span><span> </span><span class="annot"><span class="annottext">ScottyException -&gt; IO Response
forall (m :: * -&gt; *). MonadIO m =&gt; ScottyException -&gt; m Response
</span><a href="Web.Scotty.Trans.html#unhandledExceptionHandler"><span class="hs-identifier hs-var">unhandledExceptionHandler</span></a></span><span>
</span><span id="line-134"></span><span>          </span><span class="annot"><span class="annottext">Response -&gt; IO b
</span><a href="#local-6989586621679122759"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679122761"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="annottext">Application -&gt; n Application
forall a. a -&gt; n a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Application -&gt; n Application) -&gt; Application -&gt; n Application
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Application -&gt; [Application -&gt; Application] -&gt; Application
forall (t :: * -&gt; *) a. Foldable t =&gt; a -&gt; t (a -&gt; a) -&gt; a
</span><a href="Web.Scotty.Trans.html#applyAll"><span class="hs-identifier hs-var">applyAll</span></a></span><span> </span><span class="annot"><span class="annottext">Application
forall {b}. Request -&gt; (Response -&gt; IO b) -&gt; IO b
</span><a href="#local-6989586621679122757"><span class="hs-identifier hs-var">rapp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScottyState m -&gt; [Application -&gt; Application]
forall (m :: * -&gt; *). ScottyState m -&gt; [Application -&gt; Application]
</span><a href="Web.Scotty.Internal.Types.html#middlewares"><span class="hs-identifier hs-var">middlewares</span></a></span><span> </span><span class="annot"><span class="annottext">ScottyState m
</span><a href="#local-6989586621679122741"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">--- | Exception handler in charge of 'ScottyException' that's not caught by 'scottyExceptionHandler'</span><span>
</span><span id="line-138"></span><span id="local-6989586621679122529"><span class="annot"><a href="Web.Scotty.Trans.html#unhandledExceptionHandler"><span class="hs-identifier hs-type">unhandledExceptionHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679122529"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyException"><span class="hs-identifier hs-type">ScottyException</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122529"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Response</span></span></span><span>
</span><span id="line-139"></span><span id="unhandledExceptionHandler"><span class="annot"><span class="annottext">unhandledExceptionHandler :: forall (m :: * -&gt; *). MonadIO m =&gt; ScottyException -&gt; m Response
</span><a href="Web.Scotty.Trans.html#unhandledExceptionHandler"><span class="hs-identifier hs-var hs-var">unhandledExceptionHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">ScottyException
</span><a href="Web.Scotty.Internal.Types.html#RequestTooLarge"><span class="hs-identifier hs-var">RequestTooLarge</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Response -&gt; m Response
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Response -&gt; m Response) -&gt; Response -&gt; m Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ResponseHeaders -&gt; Builder -&gt; Response
</span><span class="hs-identifier hs-var">W.responseBuilder</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status413</span></span><span> </span><span class="annot"><span class="annottext">ResponseHeaders
</span><a href="#local-6989586621679122778"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;Request is too big Jim!&quot;</span></span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679122779"><span class="annot"><span class="annottext">ScottyException
</span><a href="#local-6989586621679122779"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Response -&gt; m Response
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Response -&gt; m Response) -&gt; Response -&gt; m Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ResponseHeaders -&gt; Builder -&gt; Response
</span><span class="hs-identifier hs-var">W.responseBuilder</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status500</span></span><span> </span><span class="annot"><span class="annottext">ResponseHeaders
</span><a href="#local-6989586621679122778"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Response) -&gt; Builder -&gt; Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;Internal Server Error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Builder
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScottyException -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ScottyException
</span><a href="#local-6989586621679122779"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679122778"><span class="annot"><span class="annottext">ct :: ResponseHeaders
</span><a href="#local-6989586621679122778"><span class="hs-identifier hs-var hs-var">ct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/plain&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621679122520"><span id="local-6989586621679122521"><span class="annot"><a href="Web.Scotty.Trans.html#applyAll"><span class="hs-identifier hs-type">applyAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679122520"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122521"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122520"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122521"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122521"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122521"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-146"></span><span id="applyAll"><span class="annot"><span class="annottext">applyAll :: forall (t :: * -&gt; *) a. Foldable t =&gt; a -&gt; t (a -&gt; a) -&gt; a
</span><a href="Web.Scotty.Trans.html#applyAll"><span class="hs-identifier hs-var hs-var">applyAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a -&gt; a) -&gt; a) -&gt; a -&gt; t (a -&gt; a) -&gt; a
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((a -&gt; a) -&gt; a -&gt; a) -&gt; a -&gt; (a -&gt; a) -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621679122522"><span class="annot"><a href="Web.Scotty.Trans.html#notFoundApp"><span class="hs-identifier hs-type">notFoundApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679122522"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122522"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-149"></span><span id="notFoundApp"><span class="annot"><span class="annottext">notFoundApp :: forall (m :: * -&gt; *). Monad m =&gt; Application m
</span><a href="Web.Scotty.Trans.html#notFoundApp"><span class="hs-identifier hs-var hs-var">notFoundApp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response -&gt; m Response
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Response -&gt; m Response) -&gt; Response -&gt; m Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ResponseHeaders -&gt; Builder -&gt; Response
</span><span class="hs-identifier hs-var">W.responseBuilder</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status404</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;text/html&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>                       </span><span class="annot"><span class="annottext">(Builder -&gt; Response) -&gt; Builder -&gt; Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">fromByteString</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&lt;h1&gt;404: File Not Found!&lt;/h1&gt;&quot;</span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><span class="hs-comment">-- | Global handler for user-defined exceptions.</span></span><span>
</span><span id="line-153"></span><span id="local-6989586621679122551"><span class="annot"><a href="Web.Scotty.Trans.html#defaultHandler"><span class="hs-identifier hs-type">defaultHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679122551"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ErrorHandler"><span class="hs-identifier hs-type">ErrorHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122551"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier hs-type">ScottyT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122551"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-154"></span><span id="defaultHandler"><span class="annot"><span class="annottext">defaultHandler :: forall (m :: * -&gt; *). Monad m =&gt; ErrorHandler m -&gt; ScottyT m ()
</span><a href="Web.Scotty.Trans.html#defaultHandler"><span class="hs-identifier hs-var hs-var">defaultHandler</span></a></span></span><span> </span><span id="local-6989586621679122803"><span class="annot"><span class="annottext">ErrorHandler m
</span><a href="#local-6989586621679122803"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (ScottyState m) () -&gt; ScottyT m ()
forall (m :: * -&gt; *) a. State (ScottyState m) a -&gt; ScottyT m a
</span><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier hs-var">ScottyT</span></a></span><span> </span><span class="annot"><span class="annottext">(State (ScottyState m) () -&gt; ScottyT m ())
-&gt; State (ScottyState m) () -&gt; ScottyT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ScottyState m -&gt; ScottyState m) -&gt; State (ScottyState m) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((ScottyState m -&gt; ScottyState m) -&gt; State (ScottyState m) ())
-&gt; (ScottyState m -&gt; ScottyState m) -&gt; State (ScottyState m) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ErrorHandler m) -&gt; ScottyState m -&gt; ScottyState m
forall (m :: * -&gt; *).
Maybe (ErrorHandler m) -&gt; ScottyState m -&gt; ScottyState m
</span><a href="Web.Scotty.Internal.Types.html#setHandler"><span class="hs-identifier hs-var">setHandler</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (ErrorHandler m) -&gt; ScottyState m -&gt; ScottyState m)
-&gt; Maybe (ErrorHandler m) -&gt; ScottyState m -&gt; ScottyState m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ErrorHandler m -&gt; Maybe (ErrorHandler m)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ErrorHandler m
</span><a href="#local-6989586621679122803"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Use given middleware. Middleware is nested such that the first declared</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- is the outermost middleware (it has first dibs on the request and last action</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- on the response). Every middleware is run on each request.</span><span>
</span><span id="line-159"></span><span id="local-6989586621679122564"><span class="annot"><a href="Web.Scotty.Trans.html#middleware"><span class="hs-identifier hs-type">middleware</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Middleware</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier hs-type">ScottyT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122564"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-160"></span><span id="middleware"><span class="annot"><span class="annottext">middleware :: forall (m :: * -&gt; *). (Application -&gt; Application) -&gt; ScottyT m ()
</span><a href="Web.Scotty.Trans.html#middleware"><span class="hs-identifier hs-var hs-var">middleware</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (ScottyState m) () -&gt; ScottyT m ()
forall (m :: * -&gt; *) a. State (ScottyState m) a -&gt; ScottyT m a
</span><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier hs-var">ScottyT</span></a></span><span> </span><span class="annot"><span class="annottext">(State (ScottyState m) () -&gt; ScottyT m ())
-&gt; ((Application -&gt; Application) -&gt; State (ScottyState m) ())
-&gt; (Application -&gt; Application)
-&gt; ScottyT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ScottyState m -&gt; ScottyState m) -&gt; State (ScottyState m) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((ScottyState m -&gt; ScottyState m) -&gt; State (ScottyState m) ())
-&gt; ((Application -&gt; Application) -&gt; ScottyState m -&gt; ScottyState m)
-&gt; (Application -&gt; Application)
-&gt; State (ScottyState m) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Application -&gt; Application) -&gt; ScottyState m -&gt; ScottyState m
forall (m :: * -&gt; *).
(Application -&gt; Application) -&gt; ScottyState m -&gt; ScottyState m
</span><a href="Web.Scotty.Internal.Types.html#addMiddleware"><span class="hs-identifier hs-var">addMiddleware</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | Set global size limit for the request body. Requests with body size exceeding the limit will not be</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- processed and an HTTP response 413 will be returned to the client. Size limit needs to be greater than 0, </span><span>
</span><span id="line-164"></span><span class="hs-comment">-- otherwise the application will terminate on start.</span><span>
</span><span id="line-165"></span><span id="local-6989586621679122567"><span class="annot"><a href="Web.Scotty.Trans.html#setMaxRequestBodySize"><span class="hs-identifier hs-type">setMaxRequestBodySize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#Kilobytes"><span class="hs-identifier hs-type">Kilobytes</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Request size limit</span></span><span>
</span><span id="line-166"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier hs-type">ScottyT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122567"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-167"></span><span id="setMaxRequestBodySize"><span class="annot"><span class="annottext">setMaxRequestBodySize :: forall (m :: * -&gt; *). Port -&gt; ScottyT m ()
</span><a href="Web.Scotty.Trans.html#setMaxRequestBodySize"><span class="hs-identifier hs-var hs-var">setMaxRequestBodySize</span></a></span></span><span> </span><span id="local-6989586621679122813"><span class="annot"><span class="annottext">Port
</span><a href="#local-6989586621679122813"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ScottyT m () -&gt; ScottyT m ()
forall a. (?callStack::CallStack) =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Port
</span><a href="#local-6989586621679122813"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Port -&gt; Port -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Port
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ScottyT m () -&gt; ScottyT m ()) -&gt; ScottyT m () -&gt; ScottyT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State (ScottyState m) () -&gt; ScottyT m ()
forall (m :: * -&gt; *) a. State (ScottyState m) a -&gt; ScottyT m a
</span><a href="Web.Scotty.Internal.Types.html#ScottyT"><span class="hs-identifier hs-var">ScottyT</span></a></span><span> </span><span class="annot"><span class="annottext">(State (ScottyState m) () -&gt; ScottyT m ())
-&gt; (RouteOptions -&gt; State (ScottyState m) ())
-&gt; RouteOptions
-&gt; ScottyT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ScottyState m -&gt; ScottyState m) -&gt; State (ScottyState m) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((ScottyState m -&gt; ScottyState m) -&gt; State (ScottyState m) ())
-&gt; (RouteOptions -&gt; ScottyState m -&gt; ScottyState m)
-&gt; RouteOptions
-&gt; State (ScottyState m) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RouteOptions -&gt; ScottyState m -&gt; ScottyState m
forall (m :: * -&gt; *).
RouteOptions -&gt; ScottyState m -&gt; ScottyState m
</span><a href="Web.Scotty.Internal.Types.html#updateMaxRequestBodySize"><span class="hs-identifier hs-var">updateMaxRequestBodySize</span></a></span><span> </span><span class="annot"><span class="annottext">(RouteOptions -&gt; ScottyT m ()) -&gt; RouteOptions -&gt; ScottyT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RouteOptions
</span><a href="Web.Scotty.Internal.Types.html#defaultRouteOptions"><span class="hs-identifier hs-var">defaultRouteOptions</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Web.Scotty.Internal.Types.html#maxRequestBodySize"><span class="hs-identifier hs-var">maxRequestBodySize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679122813"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span></pre></body></html>