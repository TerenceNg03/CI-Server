<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Fmt.Internal.Formatters</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Generic useful things</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intersperse</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 804
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-comment">-- Text</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TL</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- 'Buildable' and text-format stuff</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Formatting.Buildable</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Formatting.Internal.Raw</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-24"></span><span class="hs-comment">-- Text 'Builder'</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy.Builder</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromString</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- 'Foldable' and 'IsList' for list/map formatters</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Item</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IsList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Fmt.Internal.Core.html"><span class="hs-identifier">Fmt.Internal.Core</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- Doctest setup</span><span>
</span><span id="line-36"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- &gt;&gt;&gt; import Fmt</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- Text formatters</span><span>
</span><span id="line-43"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><span class="hs-comment">{- |
Indent a block of text.

&gt;&gt;&gt; fmt $ &quot;This is a list:\n&quot; &lt;&gt; indentF 4 (blockListF [1,2,3])
This is a list:
    - 1
    - 2
    - 3

The output will always end with a newline, even when the input doesn't.
-}</span></span><span>
</span><span id="line-56"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#indentF"><span class="hs-identifier hs-type">indentF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-57"></span><span id="indentF"><span class="annot"><span class="annottext">indentF :: Int -&gt; Builder -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#indentF"><span class="hs-identifier hs-var hs-var">indentF</span></a></span></span><span> </span><span id="local-6989586621679065462"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065462"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679065463"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065463"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">TL.lines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065463"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065467"><span class="hs-identifier hs-var">spaces</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span id="local-6989586621679065468"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679065468"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Builder) -&gt; Text -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">TL.unlines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; [Text] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065467"><span class="hs-identifier hs-var">spaces</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679065468"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>    </span><span id="local-6989586621679065467"><span class="annot"><span class="annottext">spaces :: Text
</span><a href="#local-6989586621679065467"><span class="hs-identifier hs-var hs-var">spaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065462"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">TL.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><span class="hs-comment">{- | Add a prefix to the first line, and indent all lines but the first one.

The output will always end with a newline, even when the input doesn't.
-}</span></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#indentF%27"><span class="hs-identifier hs-type">indentF'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-68"></span><span id="indentF%27"><span class="annot"><span class="annottext">indentF' :: Int -&gt; Text -&gt; Builder -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#indentF%27"><span class="hs-identifier hs-var hs-var">indentF'</span></a></span></span><span> </span><span id="local-6989586621679065473"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065473"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679065474"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065474"><span class="hs-identifier hs-var">pref</span></a></span></span><span> </span><span id="local-6989586621679065475"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065475"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">TL.lines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065475"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromText</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065474"><span class="hs-identifier hs-var">pref</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679065477"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065477"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679065478"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679065478"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Builder) -&gt; Text -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-71"></span><span>            </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">TL.unlines</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; [Text] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065474"><span class="hs-identifier hs-var">pref</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065477"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; [Text] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065480"><span class="hs-identifier hs-var">spaces</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679065478"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679065480"><span class="annot"><span class="annottext">spaces :: Text
</span><a href="#local-6989586621679065480"><span class="hs-identifier hs-var hs-var">spaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065473"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">TL.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><span class="hs-comment">{- | Attach a name to anything:

&gt;&gt;&gt; fmt $ nameF &quot;clients&quot; $ blockListF [&quot;Alice&quot;, &quot;Bob&quot;, &quot;Zalgo&quot;]
clients:
  - Alice
  - Bob
  - Zalgo
-}</span></span><span>
</span><span id="line-83"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#nameF"><span class="hs-identifier hs-type">nameF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-84"></span><span id="nameF"><span class="annot"><span class="annottext">nameF :: Builder -&gt; Builder -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#nameF"><span class="hs-identifier hs-var hs-var">nameF</span></a></span></span><span> </span><span id="local-6989586621679065482"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065482"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679065483"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065483"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">TL.lines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065483"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065482"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;:\n&quot;</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679065484"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065484"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065482"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065484"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621679065485"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679065485"><span class="hs-identifier hs-var">ls</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065482"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-88"></span><span>           </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065486"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679065486"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065486"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679065485"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><span class="hs-comment">{- | Put spaces between elements.

&gt;&gt;&gt; fmt $ unwordsF [&quot;hello&quot;, &quot;world&quot;]
hello world

Of course, it works on anything 'Buildable':

&gt;&gt;&gt; fmt $ unwordsF [1, 2]
1 2
-}</span></span><span>
</span><span id="line-100"></span><span id="local-6989586621679065312"><span id="local-6989586621679065313"><span class="annot"><a href="Fmt.Internal.Formatters.html#unwordsF"><span class="hs-identifier hs-type">unwordsF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065312"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065313"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065312"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065313"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span></span><span>
</span><span id="line-101"></span><span id="unwordsF"><span class="annot"><span class="annottext">unwordsF :: forall (f :: * -&gt; *) a. (Foldable f, Buildable a) =&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#unwordsF"><span class="hs-identifier hs-var hs-var">unwordsF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; Builder) -&gt; (f a -&gt; [Builder]) -&gt; f a -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; [Builder] -&gt; [Builder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; [Builder]) -&gt; (f a -&gt; [Builder]) -&gt; f a -&gt; [Builder]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Builder) -&gt; [a] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [Builder]) -&gt; (f a -&gt; [a]) -&gt; f a -&gt; [Builder]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; [a]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#unwordsF"><span class="hs-pragma hs-type">unwordsF</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621679065496"><span class="annot"><span class="hs-pragma hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065496"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">=&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="#local-6989586621679065496"><span class="hs-pragma hs-type">a</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Builder</span></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><span class="hs-comment">{- | Arrange elements on separate lines.

&gt;&gt;&gt; fmt $ unlinesF [&quot;hello&quot;, &quot;world&quot;]
hello
world
-}</span></span><span>
</span><span id="line-111"></span><span id="local-6989586621679065497"><span id="local-6989586621679065498"><span class="annot"><a href="Fmt.Internal.Formatters.html#unlinesF"><span class="hs-identifier hs-type">unlinesF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065497"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065498"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065497"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065498"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span></span><span>
</span><span id="line-112"></span><span id="unlinesF"><span class="annot"><span class="annottext">unlinesF :: forall (f :: * -&gt; *) a. (Foldable f, Buildable a) =&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#unlinesF"><span class="hs-identifier hs-var hs-var">unlinesF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; Builder) -&gt; (f a -&gt; [Builder]) -&gt; f a -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Builder) -&gt; [a] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Builder
</span><a href="#local-6989586621679065505"><span class="hs-identifier hs-var">nl</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Builder) -&gt; (a -&gt; Builder) -&gt; a -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [Builder]) -&gt; (f a -&gt; [a]) -&gt; f a -&gt; [Builder]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; [a]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679065505"><span class="annot"><span class="annottext">nl :: Builder -&gt; Builder
</span><a href="#local-6989586621679065505"><span class="hs-identifier hs-var hs-var">nl</span></a></span></span><span> </span><span id="local-6989586621679065509"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065509"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`TL.isSuffixOf`</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065509"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065509"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-115"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065509"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#unlinesF"><span class="hs-pragma hs-type">unlinesF</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621679065511"><span class="annot"><span class="hs-pragma hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065511"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">=&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="#local-6989586621679065511"><span class="hs-pragma hs-type">a</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Builder</span></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- List formatters</span><span>
</span><span id="line-121"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><span class="hs-comment">{- | A simple comma-separated list formatter.

&gt;&gt;&gt; listF [&quot;hello&quot;, &quot;world&quot;]
&quot;[hello, world]&quot;

For multiline output, use 'jsonListF'.
-}</span></span><span>
</span><span id="line-130"></span><span id="local-6989586621679065513"><span id="local-6989586621679065514"><span class="annot"><a href="Fmt.Internal.Formatters.html#listF"><span class="hs-identifier hs-type">listF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065513"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065513"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span></span><span>
</span><span id="line-131"></span><span id="listF"><span class="annot"><span class="annottext">listF :: forall (f :: * -&gt; *) a. (Foldable f, Buildable a) =&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#listF"><span class="hs-identifier hs-var hs-var">listF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Builder) -&gt; f a -&gt; Builder
forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; Builder) -&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#listF%27"><span class="hs-identifier hs-var">listF'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span>
</span><span id="line-132"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#listF"><span class="hs-pragma hs-type">listF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><span class="hs-comment">{- | A version of 'listF' that lets you supply your own building function for
list elements.

For instance, to format a list of numbers as hex:

&gt;&gt;&gt; listF' hexF [1234, 5678]
&quot;[4d2, 162e]&quot;
-}</span></span><span>
</span><span id="line-142"></span><span id="local-6989586621679065327"><span id="local-6989586621679065328"><span class="annot"><a href="Fmt.Internal.Formatters.html#listF%27"><span class="hs-identifier hs-type">listF'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065327"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065328"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065327"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065328"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span></span><span>
</span><span id="line-143"></span><span id="listF%27"><span class="annot"><span class="annottext">listF' :: forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; Builder) -&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#listF%27"><span class="hs-identifier hs-var hs-var">listF'</span></a></span></span><span> </span><span id="local-6989586621679065527"><span class="annot"><span class="annottext">a -&gt; Builder
</span><a href="#local-6989586621679065527"><span class="hs-identifier hs-var">fbuild</span></a></span></span><span> </span><span id="local-6989586621679065528"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679065528"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; Builder) -&gt; [Builder] -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; [Builder] -&gt; [Builder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><span class="annottext">Builder -&gt; [Builder] -&gt; [Builder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Builder) -&gt; [a] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
</span><a href="#local-6989586621679065527"><span class="hs-identifier hs-var">fbuild</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; [a]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679065528"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; [Builder] -&gt; [Builder]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;]&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#listF%27"><span class="hs-pragma hs-type">listF'</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621679065529"><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621679065529"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Builder</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="#local-6989586621679065529"><span class="hs-pragma hs-type">a</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Builder</span></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">{- Note [Builder appending]
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The documentation for 'Builder' says that it's preferrable to associate
'Builder' appends to the right (i.e. @a &lt;&gt; (b &lt;&gt; c)@). The maximum possible
association-to-the-right is achieved when we avoid appending builders until
the last second (i.e. in the latter scenario):

    -- (a1 &lt;&gt; x) &lt;&gt; (a2 &lt;&gt; x) &lt;&gt; ...
    mconcat [a &lt;&gt; x | a &lt;- as]

    -- a1 &lt;&gt; x &lt;&gt; a2 &lt;&gt; x &lt;&gt; ...
    mconcat $ concat [[a, x] | a &lt;- as]

However, benchmarks have shown that the former way is actually faster.
-}</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><span class="hs-comment">{- | A multiline formatter for lists.

&gt;&gt;&gt; fmt $ blockListF [1,2,3]
- 1
- 2
- 3

Multi-line elements are indented correctly:

&gt;&gt;&gt; fmt $ blockListF [&quot;hello\nworld&quot;, &quot;foo\nbar\nquix&quot;]
- hello
  world
- foo
  bar
  quix

-}</span></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#blockListF"><span class="hs-identifier hs-type">blockListF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679065531"><span class="annot"><a href="#local-6989586621679065531"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679065532"><span class="annot"><a href="#local-6989586621679065532"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065531"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065532"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065531"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065532"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-185"></span><span id="blockListF"><span class="annot"><span class="annottext">blockListF :: forall (f :: * -&gt; *) a. (Foldable f, Buildable a) =&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#blockListF"><span class="hs-identifier hs-var hs-var">blockListF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; (a -&gt; Builder) -&gt; f a -&gt; Builder
forall (f :: * -&gt; *) a.
Foldable f =&gt;
Text -&gt; (a -&gt; Builder) -&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#blockListF%27"><span class="hs-identifier hs-var">blockListF'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span>
</span><span id="line-186"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#blockListF"><span class="hs-pragma hs-type">blockListF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="annot"><span class="hs-comment">{- | A version of 'blockListF' that lets you supply your own building function
for list elements (instead of 'build') and choose the bullet character
(instead of @&quot;-&quot;@).
-}</span></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#blockListF%27"><span class="hs-identifier hs-type">blockListF'</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679065334"><span class="annot"><a href="#local-6989586621679065334"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679065335"><span class="annot"><a href="#local-6989586621679065335"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065334"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>                       </span><span class="annot"><span class="hs-comment">-- ^ Bullet</span></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065335"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">)</span><span>             </span><span class="annot"><span class="hs-comment">-- ^ Builder for elements</span></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065334"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065335"><span class="hs-identifier hs-type">a</span></a></span><span>                        </span><span class="annot"><span class="hs-comment">-- ^ Structure with elements</span></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-198"></span><span id="blockListF%27"><span class="annot"><span class="annottext">blockListF' :: forall (f :: * -&gt; *) a.
Foldable f =&gt;
Text -&gt; (a -&gt; Builder) -&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#blockListF%27"><span class="hs-identifier hs-var hs-var">blockListF'</span></a></span></span><span> </span><span id="local-6989586621679065568"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065568"><span class="hs-identifier hs-var">bullet</span></a></span></span><span> </span><span id="local-6989586621679065569"><span class="annot"><span class="annottext">a -&gt; Builder
</span><a href="#local-6989586621679065569"><span class="hs-identifier hs-var">fbuild</span></a></span></span><span> </span><span id="local-6989586621679065570"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679065570"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065572"><span class="hs-identifier hs-var">items</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;[]\n&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065572"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679065572"><span class="annot"><span class="annottext">items :: [Builder]
</span><a href="#local-6989586621679065572"><span class="hs-identifier hs-var hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Builder) -&gt; [a] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
</span><a href="#local-6989586621679065573"><span class="hs-identifier hs-var">buildItem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; [a]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679065570"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679065574"><span class="annot"><span class="annottext">spaces :: Builder
</span><a href="#local-6989586621679065574"><span class="hs-identifier hs-var hs-var">spaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; Builder) -&gt; [Builder] -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Builder -&gt; [Builder]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065568"><span class="hs-identifier hs-var">bullet</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Builder
</span><span class="hs-identifier hs-var">singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679065573"><span class="annot"><span class="annottext">buildItem :: a -&gt; Builder
</span><a href="#local-6989586621679065573"><span class="hs-identifier hs-var hs-var">buildItem</span></a></span></span><span> </span><span id="local-6989586621679065579"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065579"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">TL.lines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Builder
</span><a href="#local-6989586621679065569"><span class="hs-identifier hs-var">fbuild</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065579"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065568"><span class="hs-identifier hs-var">bullet</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder -&gt; Builder
forall a b. (Buildable a, FromBuilder b) =&gt; a -&gt; Builder -&gt; b
</span><a href="Fmt.Internal.Core.html#%7C%2B"><span class="hs-operator hs-var">|+</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679065581"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065581"><span class="hs-identifier hs-var">l</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679065582"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679065582"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065568"><span class="hs-identifier hs-var">bullet</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder -&gt; Builder
forall a b. (Buildable a, FromBuilder b) =&gt; a -&gt; Builder -&gt; b
</span><a href="Fmt.Internal.Core.html#%7C%2B"><span class="hs-operator hs-var">|+</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall b. FromBuilder b =&gt; Builder -&gt; Builder -&gt; b
</span><a href="Fmt.Internal.Core.html#%2B%7C"><span class="hs-operator hs-var">+|</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065581"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder -&gt; Builder
forall a b. (Buildable a, FromBuilder b) =&gt; a -&gt; Builder -&gt; b
</span><a href="Fmt.Internal.Core.html#%7C%2B"><span class="hs-operator hs-var">|+</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-205"></span><span>                </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065574"><span class="hs-identifier hs-var">spaces</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065584"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679065584"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065584"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679065582"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#blockListF%27"><span class="hs-pragma hs-type">blockListF'</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621679065585"><span class="annot"><span class="hs-pragma hs-type">Text</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621679065585"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Builder</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="#local-6989586621679065585"><span class="hs-pragma hs-type">a</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Builder</span></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><span class="hs-comment">{- | A JSON-style formatter for lists.

&gt;&gt;&gt; fmt $ jsonListF [1,2,3]
[
  1
, 2
, 3
]

Like 'blockListF', it handles multiline elements well:

&gt;&gt;&gt; fmt $ jsonListF [&quot;hello\nworld&quot;, &quot;foo\nbar\nquix&quot;]
[
  hello
  world
, foo
  bar
  quix
]
-}</span></span><span>
</span><span id="line-229"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#jsonListF"><span class="hs-identifier hs-type">jsonListF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679065586"><span class="annot"><a href="#local-6989586621679065586"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679065587"><span class="annot"><a href="#local-6989586621679065587"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065586"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065587"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065586"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065587"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-230"></span><span id="jsonListF"><span class="annot"><span class="annottext">jsonListF :: forall (f :: * -&gt; *) a. (Foldable f, Buildable a) =&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#jsonListF"><span class="hs-identifier hs-var hs-var">jsonListF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Builder) -&gt; f a -&gt; Builder
forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; Builder) -&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#jsonListF%27"><span class="hs-identifier hs-var">jsonListF'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span>
</span><span id="line-231"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#jsonListF"><span class="hs-pragma hs-type">jsonListF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><span class="hs-comment">{- | A version of 'jsonListF' that lets you supply your own building function
for list elements.
-}</span></span><span>
</span><span id="line-236"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#jsonListF%27"><span class="hs-identifier hs-type">jsonListF'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679065593"><span class="annot"><a href="#local-6989586621679065593"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679065594"><span class="annot"><a href="#local-6989586621679065594"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065593"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065594"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065593"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065594"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-237"></span><span id="jsonListF%27"><span class="annot"><span class="annottext">jsonListF' :: forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; Builder) -&gt; f a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#jsonListF%27"><span class="hs-identifier hs-var hs-var">jsonListF'</span></a></span></span><span> </span><span id="local-6989586621679065624"><span class="annot"><span class="annottext">a -&gt; Builder
</span><a href="#local-6989586621679065624"><span class="hs-identifier hs-var">fbuild</span></a></span></span><span> </span><span id="local-6989586621679065625"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679065625"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065626"><span class="hs-identifier hs-var">items</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;[]\n&quot;</span></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;[\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065626"><span class="hs-identifier hs-var">items</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;]\n&quot;</span></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679065626"><span class="annot"><span class="annottext">items :: [Builder]
</span><a href="#local-6989586621679065626"><span class="hs-identifier hs-var hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; a -&gt; Builder) -&gt; [Bool] -&gt; [a] -&gt; [Builder]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Builder
</span><a href="#local-6989586621679065628"><span class="hs-identifier hs-var">buildItem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool] -&gt; [Bool]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; [a]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679065625"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-comment">-- Item builder</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><a href="#local-6989586621679065628"><span class="hs-identifier hs-type">buildItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065594"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679065628"><span class="annot"><span class="annottext">buildItem :: Bool -&gt; a -&gt; Builder
</span><a href="#local-6989586621679065628"><span class="hs-identifier hs-var hs-var">buildItem</span></a></span></span><span> </span><span id="local-6989586621679065630"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065630"><span class="hs-identifier hs-var">isFirst</span></a></span></span><span> </span><span id="local-6989586621679065631"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065631"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Builder) -&gt; [Text] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">TL.lines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Builder
</span><a href="#local-6989586621679065624"><span class="hs-identifier hs-var">fbuild</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065631"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-246"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065630"><span class="hs-identifier hs-var">isFirst</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-247"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;,\n&quot;</span></span><span>
</span><span id="line-248"></span><span>        </span><span id="local-6989586621679065632"><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065632"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-249"></span><span>            </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; Builder)
-&gt; ([Builder] -&gt; [Builder]) -&gt; [Builder] -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Builder) -&gt; [Builder] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; Builder) -&gt; [Builder] -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-250"></span><span>              </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065632"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; ([Builder] -&gt; [Builder]) -&gt; [Builder]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Identity Builder) -&gt; [Builder] -&gt; Identity [Builder]
forall s a. Cons s s a a =&gt; Traversal' s a
Traversal' [Builder] Builder
</span><span class="hs-identifier hs-var">_head</span></span><span> </span><span class="annot"><span class="annottext">((Builder -&gt; Identity Builder) -&gt; [Builder] -&gt; Identity [Builder])
-&gt; (Builder -&gt; Builder) -&gt; [Builder] -&gt; [Builder]
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065630"><span class="hs-identifier hs-var">isFirst</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>                 </span><span class="annot"><span class="annottext">[Builder] -&gt; ([Builder] -&gt; [Builder]) -&gt; [Builder]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; Identity [Builder])
-&gt; [Builder] -&gt; Identity [Builder]
forall s a. Cons s s a a =&gt; Traversal' s s
Traversal' [Builder] [Builder]
</span><span class="hs-identifier hs-var">_tail</span></span><span class="annot"><span class="annottext">(([Builder] -&gt; Identity [Builder])
 -&gt; [Builder] -&gt; Identity [Builder])
-&gt; ((Builder -&gt; Identity Builder)
    -&gt; [Builder] -&gt; Identity [Builder])
-&gt; (Builder -&gt; Identity Builder)
-&gt; [Builder]
-&gt; Identity [Builder]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Builder -&gt; Identity Builder) -&gt; [Builder] -&gt; Identity [Builder]
forall s t a b. Each s t a b =&gt; Traversal s t a b
Traversal' [Builder] Builder
</span><span class="hs-identifier hs-var">each</span></span><span> </span><span class="annot"><span class="annottext">((Builder -&gt; Identity Builder) -&gt; [Builder] -&gt; Identity [Builder])
-&gt; (Builder -&gt; Builder) -&gt; [Builder] -&gt; [Builder]
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#jsonListF%27"><span class="hs-pragma hs-type">jsonListF'</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621679065638"><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621679065638"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Builder</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="#local-6989586621679065638"><span class="hs-pragma hs-type">a</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Builder</span></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- Map formatters</span><span>
</span><span id="line-257"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><span class="hs-comment">{- | A simple JSON-like map formatter; works for Map, HashMap, etc, as well as
ordinary lists of pairs.

&gt;&gt;&gt; mapF [(&quot;a&quot;, 1), (&quot;b&quot;, 4)]
&quot;{a: 1, b: 4}&quot;

For multiline output, use 'jsonMapF'.
-}</span></span><span>
</span><span id="line-267"></span><span id="local-6989586621679065377"><span id="local-6989586621679065379"><span id="local-6989586621679065380"><span class="annot"><a href="Fmt.Internal.Formatters.html#mapF"><span class="hs-identifier hs-type">mapF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsList</span></span><span> </span><span class="annot"><a href="#local-6989586621679065377"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Item</span></span><span> </span><span class="annot"><a href="#local-6989586621679065377"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065379"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065380"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065379"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065380"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065377"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span></span></span><span>
</span><span id="line-268"></span><span id="mapF"><span class="annot"><span class="annottext">mapF :: forall t k v.
(IsList t, Item t ~ (k, v), Buildable k, Buildable v) =&gt;
t -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#mapF"><span class="hs-identifier hs-var hs-var">mapF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Builder) -&gt; (v -&gt; Builder) -&gt; t -&gt; Builder
forall t k v.
(IsList t, Item t ~ (k, v)) =&gt;
(k -&gt; Builder) -&gt; (v -&gt; Builder) -&gt; t -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#mapF%27"><span class="hs-identifier hs-var">mapF'</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span>
</span><span id="line-269"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#mapF"><span class="hs-pragma hs-type">mapF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><span class="hs-comment">{- | A version of 'mapF' that lets you supply your own building function for
keys and values.
-}</span></span><span>
</span><span id="line-274"></span><span id="local-6989586621679065386"><span id="local-6989586621679065387"><span id="local-6989586621679065388"><span class="annot"><a href="Fmt.Internal.Formatters.html#mapF%27"><span class="hs-identifier hs-type">mapF'</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsList</span></span><span> </span><span class="annot"><a href="#local-6989586621679065386"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Item</span></span><span> </span><span class="annot"><a href="#local-6989586621679065386"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065387"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065388"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065387"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065388"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065386"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span></span></span><span>
</span><span id="line-277"></span><span id="mapF%27"><span class="annot"><span class="annottext">mapF' :: forall t k v.
(IsList t, Item t ~ (k, v)) =&gt;
(k -&gt; Builder) -&gt; (v -&gt; Builder) -&gt; t -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#mapF%27"><span class="hs-identifier hs-var hs-var">mapF'</span></a></span></span><span> </span><span id="local-6989586621679065665"><span class="annot"><span class="annottext">k -&gt; Builder
</span><a href="#local-6989586621679065665"><span class="hs-identifier hs-var">fbuild_k</span></a></span></span><span> </span><span id="local-6989586621679065666"><span class="annot"><span class="annottext">v -&gt; Builder
</span><a href="#local-6989586621679065666"><span class="hs-identifier hs-var">fbuild_v</span></a></span></span><span> </span><span id="local-6989586621679065667"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065667"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; [Builder] -&gt; [Builder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; Builder) -&gt; [(k, v)] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; Builder
</span><a href="#local-6989586621679065668"><span class="hs-identifier hs-var">buildPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; [Item t]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">IsList.toList</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065667"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679065668"><span class="annot"><span class="annottext">buildPair :: (k, v) -&gt; Builder
</span><a href="#local-6989586621679065668"><span class="hs-identifier hs-var hs-var">buildPair</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065669"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679065669"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065670"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679065670"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Builder
</span><a href="#local-6989586621679065665"><span class="hs-identifier hs-var">fbuild_k</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679065669"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; Builder
</span><a href="#local-6989586621679065666"><span class="hs-identifier hs-var">fbuild_v</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679065670"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><span class="hs-comment">{- | A YAML-like map formatter:

&gt;&gt;&gt; fmt $ blockMapF [(&quot;Odds&quot;, blockListF [1,3]), (&quot;Evens&quot;, blockListF [2,4])]
Odds:
  - 1
  - 3
Evens:
  - 2
  - 4
-}</span></span><span>
</span><span id="line-292"></span><span id="local-6989586621679065671"><span id="local-6989586621679065672"><span id="local-6989586621679065673"><span class="annot"><a href="Fmt.Internal.Formatters.html#blockMapF"><span class="hs-identifier hs-type">blockMapF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsList</span></span><span> </span><span class="annot"><a href="#local-6989586621679065671"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Item</span></span><span> </span><span class="annot"><a href="#local-6989586621679065671"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065672"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065673"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065672"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065673"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065671"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span></span></span><span>
</span><span id="line-293"></span><span id="blockMapF"><span class="annot"><span class="annottext">blockMapF :: forall t k v.
(IsList t, Item t ~ (k, v), Buildable k, Buildable v) =&gt;
t -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#blockMapF"><span class="hs-identifier hs-var hs-var">blockMapF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Builder) -&gt; (v -&gt; Builder) -&gt; t -&gt; Builder
forall t k v.
(IsList t, Item t ~ (k, v)) =&gt;
(k -&gt; Builder) -&gt; (v -&gt; Builder) -&gt; t -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#blockMapF%27"><span class="hs-identifier hs-var">blockMapF'</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span>
</span><span id="line-294"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#blockMapF"><span class="hs-pragma hs-type">blockMapF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><span class="hs-comment">{- | A version of 'blockMapF' that lets you supply your own building function
for keys and values.
-}</span></span><span>
</span><span id="line-299"></span><span id="local-6989586621679065686"><span id="local-6989586621679065687"><span id="local-6989586621679065688"><span class="annot"><a href="Fmt.Internal.Formatters.html#blockMapF%27"><span class="hs-identifier hs-type">blockMapF'</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsList</span></span><span> </span><span class="annot"><a href="#local-6989586621679065686"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Item</span></span><span> </span><span class="annot"><a href="#local-6989586621679065686"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065687"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065688"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065687"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065688"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065686"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span></span></span><span>
</span><span id="line-302"></span><span id="blockMapF%27"><span class="annot"><span class="annottext">blockMapF' :: forall t k v.
(IsList t, Item t ~ (k, v)) =&gt;
(k -&gt; Builder) -&gt; (v -&gt; Builder) -&gt; t -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#blockMapF%27"><span class="hs-identifier hs-var hs-var">blockMapF'</span></a></span></span><span> </span><span id="local-6989586621679065696"><span class="annot"><span class="annottext">k -&gt; Builder
</span><a href="#local-6989586621679065696"><span class="hs-identifier hs-var">fbuild_k</span></a></span></span><span> </span><span id="local-6989586621679065697"><span class="annot"><span class="annottext">v -&gt; Builder
</span><a href="#local-6989586621679065697"><span class="hs-identifier hs-var">fbuild_v</span></a></span></span><span> </span><span id="local-6989586621679065698"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065698"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065699"><span class="hs-identifier hs-var">items</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;{}\n&quot;</span></span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065699"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679065699"><span class="annot"><span class="annottext">items :: [Builder]
</span><a href="#local-6989586621679065699"><span class="hs-identifier hs-var hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Builder) -&gt; [(k, v)] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679065700"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679065700"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065701"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679065701"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#nameF"><span class="hs-identifier hs-var">nameF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Builder
</span><a href="#local-6989586621679065696"><span class="hs-identifier hs-var">fbuild_k</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679065700"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Builder
</span><a href="#local-6989586621679065697"><span class="hs-identifier hs-var">fbuild_v</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679065701"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; [Item t]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">IsList.toList</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065698"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><span class="hs-comment">{- | A JSON-like map formatter (unlike 'mapF', always multiline):

&gt;&gt;&gt; fmt $ jsonMapF [(&quot;Odds&quot;, jsonListF [1,3]), (&quot;Evens&quot;, jsonListF [2,4])]
{
  Odds:
    [
      1
    , 3
    ]
, Evens:
    [
      2
    , 4
    ]
}
-}</span></span><span>
</span><span id="line-324"></span><span id="local-6989586621679065702"><span id="local-6989586621679065703"><span id="local-6989586621679065704"><span class="annot"><a href="Fmt.Internal.Formatters.html#jsonMapF"><span class="hs-identifier hs-type">jsonMapF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsList</span></span><span> </span><span class="annot"><a href="#local-6989586621679065702"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Item</span></span><span> </span><span class="annot"><a href="#local-6989586621679065702"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065703"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065704"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065703"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065704"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065702"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span></span></span><span>
</span><span id="line-325"></span><span id="jsonMapF"><span class="annot"><span class="annottext">jsonMapF :: forall t k v.
(IsList t, Item t ~ (k, v), Buildable k, Buildable v) =&gt;
t -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#jsonMapF"><span class="hs-identifier hs-var hs-var">jsonMapF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Builder) -&gt; (v -&gt; Builder) -&gt; t -&gt; Builder
forall t k v.
(IsList t, Item t ~ (k, v)) =&gt;
(k -&gt; Builder) -&gt; (v -&gt; Builder) -&gt; t -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#jsonMapF%27"><span class="hs-identifier hs-var">jsonMapF'</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span>
</span><span id="line-326"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#jsonMapF"><span class="hs-pragma hs-type">jsonMapF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="annot"><span class="hs-comment">{- | A version of 'jsonMapF' that lets you supply your own building function
for keys and values.
-}</span></span><span>
</span><span id="line-331"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#jsonMapF%27"><span class="hs-identifier hs-type">jsonMapF'</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679065716"><span class="annot"><a href="#local-6989586621679065716"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679065717"><span class="annot"><a href="#local-6989586621679065717"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679065718"><span class="annot"><a href="#local-6989586621679065718"><span class="hs-identifier hs-type">v</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-333"></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsList</span></span><span> </span><span class="annot"><a href="#local-6989586621679065716"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Item</span></span><span> </span><span class="annot"><a href="#local-6989586621679065716"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065717"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065718"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065717"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065718"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065716"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-335"></span><span id="jsonMapF%27"><span class="annot"><span class="annottext">jsonMapF' :: forall t k v.
(IsList t, Item t ~ (k, v)) =&gt;
(k -&gt; Builder) -&gt; (v -&gt; Builder) -&gt; t -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#jsonMapF%27"><span class="hs-identifier hs-var hs-var">jsonMapF'</span></a></span></span><span> </span><span id="local-6989586621679065748"><span class="annot"><span class="annottext">k -&gt; Builder
</span><a href="#local-6989586621679065748"><span class="hs-identifier hs-var">fbuild_k</span></a></span></span><span> </span><span id="local-6989586621679065749"><span class="annot"><span class="annottext">v -&gt; Builder
</span><a href="#local-6989586621679065749"><span class="hs-identifier hs-var">fbuild_v</span></a></span></span><span> </span><span id="local-6989586621679065750"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065750"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065751"><span class="hs-identifier hs-var">items</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;{}\n&quot;</span></span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;{\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065751"><span class="hs-identifier hs-var">items</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;}\n&quot;</span></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679065751"><span class="annot"><span class="annottext">items :: [Builder]
</span><a href="#local-6989586621679065751"><span class="hs-identifier hs-var hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; (k, v) -&gt; Builder) -&gt; [Bool] -&gt; [(k, v)] -&gt; [Builder]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (k, v) -&gt; Builder
</span><a href="#local-6989586621679065752"><span class="hs-identifier hs-var">buildItem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool] -&gt; [Bool]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; [Item t]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">IsList.toList</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065750"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-comment">-- Item builder</span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="#local-6989586621679065752"><span class="hs-identifier hs-type">buildItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679065717"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679065718"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679065752"><span class="annot"><span class="annottext">buildItem :: Bool -&gt; (k, v) -&gt; Builder
</span><a href="#local-6989586621679065752"><span class="hs-identifier hs-var hs-var">buildItem</span></a></span></span><span> </span><span id="local-6989586621679065753"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065753"><span class="hs-identifier hs-var">isFirst</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065754"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679065754"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065755"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679065755"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679065756"><span class="annot"><span class="annottext">kb :: Builder
</span><a href="#local-6989586621679065756"><span class="hs-identifier hs-var hs-var">kb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679065753"><span class="hs-identifier hs-var">isFirst</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Builder
</span><a href="#local-6989586621679065748"><span class="hs-identifier hs-var">fbuild_k</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679065754"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-344"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Builder) -&gt; [Text] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">TL.lines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Builder
</span><a href="#local-6989586621679065749"><span class="hs-identifier hs-var">fbuild_v</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679065755"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065756"><span class="hs-identifier hs-var">kb</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;:\n&quot;</span></span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679065757"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065757"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065756"><span class="hs-identifier hs-var">kb</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065757"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621679065758"><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065758"><span class="hs-identifier hs-var">ls</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065756"><span class="hs-identifier hs-var">kb</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-348"></span><span>               </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065759"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679065759"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065759"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679065758"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- ADT formatters</span><span>
</span><span id="line-352"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="annot"><span class="hs-comment">{- | Like 'build' for 'Maybe', but displays 'Nothing' as @\&lt;Nothing\&gt;@ instead
of an empty string.

'build':

&gt;&gt;&gt; build (Nothing :: Maybe Int)
&quot;&quot;
&gt;&gt;&gt; build (Just 1 :: Maybe Int)
&quot;1&quot;

'maybeF':

&gt;&gt;&gt; maybeF (Nothing :: Maybe Int)
&quot;&lt;Nothing&gt;&quot;
&gt;&gt;&gt; maybeF (Just 1 :: Maybe Int)
&quot;1&quot;
-}</span></span><span>
</span><span id="line-371"></span><span id="local-6989586621679065405"><span class="annot"><a href="Fmt.Internal.Formatters.html#maybeF"><span class="hs-identifier hs-type">maybeF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065405"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679065405"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span><span>
</span><span id="line-372"></span><span id="maybeF"><span class="annot"><span class="annottext">maybeF :: forall a. Buildable a =&gt; Maybe a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#maybeF"><span class="hs-identifier hs-var hs-var">maybeF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; (a -&gt; Builder) -&gt; Maybe a -&gt; Builder
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;&lt;Nothing&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><span class="hs-comment">{- |
Format an 'Either':

&gt;&gt;&gt; eitherF (Right 1 :: Either Bool Int)
&quot;&lt;Right: 1&gt;&quot;
-}</span></span><span>
</span><span id="line-380"></span><span id="local-6989586621679065409"><span id="local-6989586621679065410"><span class="annot"><a href="Fmt.Internal.Formatters.html#eitherF"><span class="hs-identifier hs-type">eitherF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065409"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065410"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679065409"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065410"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span></span><span>
</span><span id="line-381"></span><span id="eitherF"><span class="annot"><span class="annottext">eitherF :: forall a b. (Buildable a, Buildable b) =&gt; Either a b -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#eitherF"><span class="hs-identifier hs-var hs-var">eitherF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Builder) -&gt; (b -&gt; Builder) -&gt; Either a b -&gt; Builder
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679065779"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065779"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;&lt;Left: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065779"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>                 </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679065780"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679065780"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;&lt;Right: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679065780"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- Other formatters</span><span>
</span><span id="line-386"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><span class="hs-comment">{- |
Take the first N characters:

&gt;&gt;&gt; prefixF 3 &quot;hello&quot;
&quot;hel&quot;
-}</span></span><span>
</span><span id="line-394"></span><span id="local-6989586621679065416"><span class="annot"><a href="Fmt.Internal.Formatters.html#prefixF"><span class="hs-identifier hs-type">prefixF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065416"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065416"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span><span>
</span><span id="line-395"></span><span id="prefixF"><span class="annot"><span class="annottext">prefixF :: forall a. Buildable a =&gt; Int -&gt; a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#prefixF"><span class="hs-identifier hs-var hs-var">prefixF</span></a></span></span><span> </span><span id="local-6989586621679065786"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065786"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Builder) -&gt; (a -&gt; Text) -&gt; a -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065786"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (a -&gt; Text) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; (a -&gt; Builder) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="annot"><span class="hs-comment">{- |
Take the last N characters:

&gt;&gt;&gt; suffixF 3 &quot;hello&quot;
&quot;llo&quot;
-}</span></span><span>
</span><span id="line-404"></span><span id="local-6989586621679065788"><span class="annot"><a href="Fmt.Internal.Formatters.html#suffixF"><span class="hs-identifier hs-type">suffixF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065788"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065788"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span><span>
</span><span id="line-405"></span><span id="suffixF"><span class="annot"><span class="annottext">suffixF :: forall a. Buildable a =&gt; Int -&gt; a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#suffixF"><span class="hs-identifier hs-var hs-var">suffixF</span></a></span></span><span> </span><span id="local-6989586621679065795"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065795"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Builder) -&gt; (a -&gt; Text) -&gt; a -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679065796"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065796"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int64
</span><span class="hs-identifier hs-var">TL.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065796"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065795"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679065796"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (a -&gt; Text) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-408"></span><span>  </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; (a -&gt; Builder) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="annot"><span class="hs-comment">{- |
@padLeftF n c@ pads the string with character @c@ from the left side until it
becomes @n@ characters wide (and does nothing if the string is already that
long, or longer):

&gt;&gt;&gt; padLeftF 5 '0' 12
&quot;00012&quot;
&gt;&gt;&gt; padLeftF 5 '0' 123456
&quot;123456&quot;
-}</span></span><span>
</span><span id="line-420"></span><span id="local-6989586621679065419"><span class="annot"><a href="Fmt.Internal.Formatters.html#padLeftF"><span class="hs-identifier hs-type">padLeftF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065419"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065419"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span><span>
</span><span id="line-421"></span><span id="padLeftF"><span class="annot"><span class="annottext">padLeftF :: forall a. Buildable a =&gt; Int -&gt; Char -&gt; a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#padLeftF"><span class="hs-identifier hs-var hs-var">padLeftF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; a -&gt; Builder
forall a. Buildable a =&gt; Int -&gt; Char -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">F.left</span></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="annot"><span class="hs-comment">{- |
@padRightF n c@ pads the string with character @c@ from the right side until
it becomes @n@ characters wide (and does nothing if the string is already
that long, or longer):

&gt;&gt;&gt; padRightF 5 ' ' &quot;foo&quot;
&quot;foo  &quot;
&gt;&gt;&gt; padRightF 5 ' ' &quot;foobar&quot;
&quot;foobar&quot;
-}</span></span><span>
</span><span id="line-433"></span><span id="local-6989586621679065803"><span class="annot"><a href="Fmt.Internal.Formatters.html#padRightF"><span class="hs-identifier hs-type">padRightF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065803"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065803"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span><span>
</span><span id="line-434"></span><span id="padRightF"><span class="annot"><span class="annottext">padRightF :: forall a. Buildable a =&gt; Int -&gt; Char -&gt; a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#padRightF"><span class="hs-identifier hs-var hs-var">padRightF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; a -&gt; Builder
forall a. Buildable a =&gt; Int -&gt; Char -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">F.right</span></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="annot"><span class="hs-comment">{- |
@padBothF n c@ pads the string with character @c@ from both sides until
it becomes @n@ characters wide (and does nothing if the string is already
that long, or longer):

&gt;&gt;&gt; padBothF 5 '=' &quot;foo&quot;
&quot;=foo=&quot;
&gt;&gt;&gt; padBothF 5 '=' &quot;foobar&quot;
&quot;foobar&quot;

When padding can't be distributed equally, the left side is preferred:

&gt;&gt;&gt; padBothF 8 '=' &quot;foo&quot;
&quot;===foo==&quot;
-}</span></span><span>
</span><span id="line-451"></span><span id="local-6989586621679065808"><span class="annot"><a href="Fmt.Internal.Formatters.html#padBothF"><span class="hs-identifier hs-type">padBothF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Buildable</span></span><span> </span><span class="annot"><a href="#local-6989586621679065808"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065808"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span></span><span>
</span><span id="line-452"></span><span id="padBothF"><span class="annot"><span class="annottext">padBothF :: forall a. Buildable a =&gt; Int -&gt; Char -&gt; a -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#padBothF"><span class="hs-identifier hs-var hs-var">padBothF</span></a></span></span><span> </span><span id="local-6989586621679065814"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065814"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679065815"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679065815"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-453"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">fromLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Builder) -&gt; (a -&gt; Text) -&gt; a -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.center</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065814"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679065815"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (a -&gt; Text) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; (a -&gt; Builder) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><span class="hs-identifier hs-var">build</span></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- Conditional formatters</span><span>
</span><span id="line-457"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="annot"><span class="hs-comment">{- | Display something only if the condition is 'True' (empty string
otherwise).

Note that it can only take a 'Builder' (because otherwise it would be
unusable with ('+|')-formatted strings which can resolve to any
'FromBuilder'). You can use 'build' to convert any value to a 'Builder'.
-}</span></span><span>
</span><span id="line-466"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#whenF"><span class="hs-identifier hs-type">whenF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-467"></span><span id="whenF"><span class="annot"><span class="annottext">whenF :: Bool -&gt; Builder -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#whenF"><span class="hs-identifier hs-var hs-var">whenF</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span id="local-6989586621679065818"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065818"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065818"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-468"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#whenF"><span class="hs-identifier hs-var">whenF</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-469"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#whenF"><span class="hs-pragma hs-type">whenF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="annot"><span class="hs-comment">{- | Display something only if the condition is 'False' (empty string
otherwise).
-}</span></span><span>
</span><span id="line-474"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#unlessF"><span class="hs-identifier hs-type">unlessF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-475"></span><span id="unlessF"><span class="annot"><span class="annottext">unlessF :: Bool -&gt; Builder -&gt; Builder
</span><a href="Fmt.Internal.Formatters.html#unlessF"><span class="hs-identifier hs-var hs-var">unlessF</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="local-6989586621679065820"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065820"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679065820"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-476"></span><span class="annot"><a href="Fmt.Internal.Formatters.html#unlessF"><span class="hs-identifier hs-var">unlessF</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-477"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Fmt.Internal.Formatters.html#unlessF"><span class="hs-pragma hs-type">unlessF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-478"></span></pre></body></html>