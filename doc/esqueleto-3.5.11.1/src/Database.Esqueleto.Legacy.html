<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | WARNING</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- This module is introduced in version @3.5.0.0@ to provide a smooth migration</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- experience from this legacy syntax to the new and improved syntax. If you've</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- imported this module, it means you've decided to use the old syntax for</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- a little bit longer, rather than migrate to the new stuff. That's fine!</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- But you should know that this module, and all of the legacy syntax, will be</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- completely removed from the library in version @4.0.0.0@.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- The @esqueleto@ EDSL (embedded domain specific language).</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- This module replaces @Database.Persist@, so instead of</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- importing that module you should just import this one:</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- -- For a module using just esqueleto.</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- import Database.Esqueleto</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- If you need to use @persistent@'s default support for queries</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- as well, either import it qualified:</span><span>
</span><span id="line-27"></span><span class="hs-comment">--</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- -- For a module that mostly uses esqueleto.</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- import Database.Esqueleto</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- import qualified Database.Persist as P</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-33"></span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- or import @esqueleto@ itself qualified:</span><span>
</span><span id="line-35"></span><span class="hs-comment">--</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- -- For a module that uses esqueleto just on some queries.</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- import Database.Persist</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- import qualified Database.Esqueleto as E</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-41"></span><span class="hs-comment">--</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- Other than identifier name clashes, @esqueleto@ does not</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- conflict with @persistent@ in any way.</span><span>
</span><span id="line-44"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Esqueleto.Legacy</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Setup</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- $setup</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Introduction</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- $introduction</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Getting started</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-comment">-- $gettingstarted</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-comment">-- * @esqueleto@'s Language</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#where_"><span class="hs-identifier">where_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#on"><span class="hs-identifier">on</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#groupBy"><span class="hs-identifier">groupBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#orderBy"><span class="hs-identifier">orderBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#rand"><span class="hs-identifier">rand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#asc"><span class="hs-identifier">asc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#desc"><span class="hs-identifier">desc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#limit"><span class="hs-identifier">limit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#offset"><span class="hs-identifier">offset</span></a></span><span>
</span><span id="line-56"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#distinct"><span class="hs-identifier">distinct</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#distinctOn"><span class="hs-identifier">distinctOn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#don"><span class="hs-identifier">don</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#distinctOnOrderBy"><span class="hs-identifier">distinctOnOrderBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#having"><span class="hs-identifier">having</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#locking"><span class="hs-identifier">locking</span></a></span><span>
</span><span id="line-57"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#sub_select"><span class="hs-identifier">sub_select</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%5E."><span class="hs-operator">(^.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3F."><span class="hs-operator">(?.)</span></a></span><span>
</span><span id="line-58"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#val"><span class="hs-identifier">val</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#isNothing"><span class="hs-identifier">isNothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#just"><span class="hs-identifier">just</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#nothing"><span class="hs-identifier">nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#joinV"><span class="hs-identifier">joinV</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#withNonNull"><span class="hs-identifier">withNonNull</span></a></span><span>
</span><span id="line-59"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#countRows"><span class="hs-identifier">countRows</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#count"><span class="hs-identifier">count</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#countDistinct"><span class="hs-identifier">countDistinct</span></a></span><span>
</span><span id="line-60"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#not_"><span class="hs-identifier">not_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3D%3D."><span class="hs-operator">(==.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3E%3D."><span class="hs-operator">(&gt;=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3E."><span class="hs-operator">(&gt;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3C%3D."><span class="hs-operator">(&lt;=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3C."><span class="hs-operator">(&lt;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%21%3D."><span class="hs-operator">(!=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%26%26."><span class="hs-operator">(&amp;&amp;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%7C%7C."><span class="hs-operator">(||.)</span></a></span><span>
</span><span id="line-61"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#between"><span class="hs-identifier">between</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2B."><span class="hs-operator">(+.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#-."><span class="hs-operator">(-.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2F."><span class="hs-operator">(/.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2A."><span class="hs-operator">(*.)</span></a></span><span>
</span><span id="line-62"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#random_"><span class="hs-identifier">random_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#round_"><span class="hs-identifier">round_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#ceiling_"><span class="hs-identifier">ceiling_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#floor_"><span class="hs-identifier">floor_</span></a></span><span>
</span><span id="line-63"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#min_"><span class="hs-identifier">min_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#max_"><span class="hs-identifier">max_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#sum_"><span class="hs-identifier">sum_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#avg_"><span class="hs-identifier">avg_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#castNum"><span class="hs-identifier">castNum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#castNumM"><span class="hs-identifier">castNumM</span></a></span><span>
</span><span id="line-64"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#coalesce"><span class="hs-identifier">coalesce</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#coalesceDefault"><span class="hs-identifier">coalesceDefault</span></a></span><span>
</span><span id="line-65"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#lower_"><span class="hs-identifier">lower_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#upper_"><span class="hs-identifier">upper_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#trim_"><span class="hs-identifier">trim_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#ltrim_"><span class="hs-identifier">ltrim_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#rtrim_"><span class="hs-identifier">rtrim_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#length_"><span class="hs-identifier">length_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#left_"><span class="hs-identifier">left_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#right_"><span class="hs-identifier">right_</span></a></span><span>
</span><span id="line-66"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#like"><span class="hs-identifier">like</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#ilike"><span class="hs-identifier">ilike</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%25"><span class="hs-operator">(%)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#concat_"><span class="hs-identifier">concat_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2B%2B."><span class="hs-operator">(++.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#castString"><span class="hs-identifier">castString</span></a></span><span>
</span><span id="line-67"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subList_select"><span class="hs-identifier">subList_select</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#valList"><span class="hs-identifier">valList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#justList"><span class="hs-identifier">justList</span></a></span><span>
</span><span id="line-68"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#in_"><span class="hs-identifier">in_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#notIn"><span class="hs-identifier">notIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#exists"><span class="hs-identifier">exists</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#notExists"><span class="hs-identifier">notExists</span></a></span><span>
</span><span id="line-69"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#set"><span class="hs-identifier">set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3D."><span class="hs-operator">(=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2B%3D."><span class="hs-operator">(+=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#-%3D."><span class="hs-operator">(-=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2A%3D."><span class="hs-operator">(*=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2F%3D."><span class="hs-operator">(/=.)</span></a></span><span>
</span><span id="line-70"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#case_"><span class="hs-identifier">case_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#toBaseId"><span class="hs-identifier">toBaseId</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelect"><span class="hs-identifier">subSelect</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelectMaybe"><span class="hs-identifier">subSelectMaybe</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelectCount"><span class="hs-identifier">subSelectCount</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelectForeign"><span class="hs-identifier">subSelectForeign</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelectList"><span class="hs-identifier">subSelectList</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelectUnsafe"><span class="hs-identifier">subSelectUnsafe</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#ToBaseId"><span class="hs-identifier">ToBaseId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#when_"><span class="hs-identifier">when_</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#then_"><span class="hs-identifier">then_</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#else_"><span class="hs-identifier">else_</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#from"><span class="hs-identifier">from</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#ValueList"><span class="hs-identifier">ValueList</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#OrderBy"><span class="hs-identifier">OrderBy</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#DistinctOn"><span class="hs-identifier">DistinctOn</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#LockingKind"><span class="hs-identifier">LockingKind</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#LockableEntity"><span class="hs-identifier">LockableEntity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#SqlString"><span class="hs-identifier">SqlString</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Joins</span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#InnerJoin"><span class="hs-identifier">InnerJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#CrossJoin"><span class="hs-identifier">CrossJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#LeftOuterJoin"><span class="hs-identifier">LeftOuterJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#RightOuterJoin"><span class="hs-identifier">RightOuterJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#FullOuterJoin"><span class="hs-identifier">FullOuterJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#JoinKind"><span class="hs-identifier">JoinKind</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#OnClauseWithoutMatchingJoinException"><span class="hs-identifier">OnClauseWithoutMatchingJoinException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="hs-comment">-- * SQL backend</span></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#SqlQuery"><span class="hs-identifier">SqlQuery</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#SqlExpr"><span class="hs-identifier">SqlExpr</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#SqlEntity"><span class="hs-identifier">SqlEntity</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#select"><span class="hs-identifier">select</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#selectOne"><span class="hs-identifier">selectOne</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#selectSource"><span class="hs-identifier">selectSource</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#delete"><span class="hs-identifier">delete</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#deleteCount"><span class="hs-identifier">deleteCount</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#update"><span class="hs-identifier">update</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#updateCount"><span class="hs-identifier">updateCount</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#insertSelect"><span class="hs-identifier">insertSelect</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#insertSelectCount"><span class="hs-identifier">insertSelectCount</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3C%23"><span class="hs-operator">(&lt;#)</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3C%26%3E"><span class="hs-operator">(&lt;&amp;&gt;)</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Rendering Queries</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#renderQueryToText"><span class="hs-identifier">renderQueryToText</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#renderQuerySelect"><span class="hs-identifier">renderQuerySelect</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#renderQueryUpdate"><span class="hs-identifier">renderQueryUpdate</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#renderQueryDelete"><span class="hs-identifier">renderQueryDelete</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#renderQueryInsertInto"><span class="hs-identifier">renderQueryInsertInto</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Internal.Language</span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#From"><span class="hs-identifier">From</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="hs-comment">-- * RDBMS-specific modules</span></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="hs-comment">-- $rdbmsSpecificModules</span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Helpers</span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#valkey"><span class="hs-identifier">valkey</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#valJ"><span class="hs-identifier">valJ</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#associateJoin"><span class="hs-identifier">associateJoin</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-exports</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="hs-comment">-- $reexports</span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#deleteKey"><span class="hs-identifier">deleteKey</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.PersistentImport.html"><span class="hs-identifier">Database.Esqueleto.Internal.PersistentImport</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html"><span class="hs-identifier">Database.Esqueleto.Internal.Internal</span></a></span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.PersistentImport.html"><span class="hs-identifier">Database.Esqueleto.Internal.PersistentImport</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-139"></span><span class="hs-comment">--</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- If you're already using @persistent@, then you're ready to use</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- @esqueleto@, no further setup is needed.  If you're just</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- starting a new project and would like to use @esqueleto@, take</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- a look at @persistent@'s book first</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- (&lt;http://www.yesodweb.com/book/persistent&gt;) to learn how to</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- define your schema.</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- $introduction</span><span>
</span><span id="line-152"></span><span class="hs-comment">--</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- The main goals of @esqueleto@ are to:</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">--   * Be easily translatable to SQL.  When you take a look at a</span><span>
</span><span id="line-156"></span><span class="hs-comment">--   @esqueleto@ query, you should be able to know exactly how</span><span>
</span><span id="line-157"></span><span class="hs-comment">--   the SQL query will end up.  (As opposed to being a</span><span>
</span><span id="line-158"></span><span class="hs-comment">--   relational algebra EDSL such as HaskellDB, which is</span><span>
</span><span id="line-159"></span><span class="hs-comment">--   non-trivial to translate into SQL.)</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">--   * Support the most widely used SQL features.  We'd like you to be</span><span>
</span><span id="line-162"></span><span class="hs-comment">--   able to use @esqueleto@ for all of your queries, no</span><span>
</span><span id="line-163"></span><span class="hs-comment">--   exceptions.  Send a pull request or open an issue on our</span><span>
</span><span id="line-164"></span><span class="hs-comment">--   project page (&lt;https://github.com/prowdsponsor/esqueleto&gt;) if</span><span>
</span><span id="line-165"></span><span class="hs-comment">--   there's anything missing that you'd like to see.</span><span>
</span><span id="line-166"></span><span class="hs-comment">--</span><span>
</span><span id="line-167"></span><span class="hs-comment">--   * Be as type-safe as possible.  We strive to provide as many</span><span>
</span><span id="line-168"></span><span class="hs-comment">--   type checks as possible.  If you get bitten by some invalid</span><span>
</span><span id="line-169"></span><span class="hs-comment">--   code that type-checks, please open an issue on our project</span><span>
</span><span id="line-170"></span><span class="hs-comment">--   page so we can take a look.</span><span>
</span><span id="line-171"></span><span class="hs-comment">--</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- However, it is /not/ a goal to be able to write portable SQL.</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- We do not try to hide the differences between DBMSs from you,</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- and @esqueleto@ code that works for one database may not work</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- on another.  This is a compromise we have to make in order to</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- give you as much control over the raw SQL as possible without</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- losing too much convenience.  This also means that you may</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- type-check a query that doesn't work on your DBMS.</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- $gettingstarted</span><span>
</span><span id="line-185"></span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- We like clean, easy-to-read EDSLs.  However, in order to</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- achieve this goal we've used a lot of type hackery, leading to</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- some hard-to-read type signatures.  On this section, we'll try</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- to build some intuition about the syntax.</span><span>
</span><span id="line-190"></span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- For the following examples, we'll use this example schema:</span><span>
</span><span id="line-192"></span><span class="hs-comment">--</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- share [mkPersist sqlSettings, mkMigrate \&quot;migrateAll\&quot;] [persist|</span><span>
</span><span id="line-195"></span><span class="hs-comment">--   Person</span><span>
</span><span id="line-196"></span><span class="hs-comment">--     name String</span><span>
</span><span id="line-197"></span><span class="hs-comment">--     age Int Maybe</span><span>
</span><span id="line-198"></span><span class="hs-comment">--     deriving Eq Show</span><span>
</span><span id="line-199"></span><span class="hs-comment">--   BlogPost</span><span>
</span><span id="line-200"></span><span class="hs-comment">--     title String</span><span>
</span><span id="line-201"></span><span class="hs-comment">--     authorId PersonId</span><span>
</span><span id="line-202"></span><span class="hs-comment">--     deriving Eq Show</span><span>
</span><span id="line-203"></span><span class="hs-comment">--   Follow</span><span>
</span><span id="line-204"></span><span class="hs-comment">--     follower PersonId</span><span>
</span><span id="line-205"></span><span class="hs-comment">--     followed PersonId</span><span>
</span><span id="line-206"></span><span class="hs-comment">--     deriving Eq Show</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- |]</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-209"></span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- Most of @esqueleto@ was created with @SELECT@ statements in</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- mind, not only because they're the most common but also</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- because they're the most complex kind of statement.  The most</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- simple kind of @SELECT@ would be:</span><span>
</span><span id="line-214"></span><span class="hs-comment">--</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- SELECT *</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- FROM Person</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- In @esqueleto@, we may write the same query above as:</span><span>
</span><span id="line-221"></span><span class="hs-comment">--</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- do people &lt;- 'select' $</span><span>
</span><span id="line-224"></span><span class="hs-comment">--              'from' $ \\person -&gt; do</span><span>
</span><span id="line-225"></span><span class="hs-comment">--              return person</span><span>
</span><span id="line-226"></span><span class="hs-comment">--    liftIO $ mapM_ (putStrLn . personName . entityVal) people</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-228"></span><span class="hs-comment">--</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- The expression above has type @SqlPersist m ()@, while</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- @people@ has type @[Entity Person]@.  The query above will be</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- translated into exactly the same query we wrote manually, but</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- instead of @SELECT *@ it will list all entity fields (using</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- @*@ is not robust).  Note that @esqueleto@ knows that we want</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- an @Entity Person@ just because of the @personName@ that we're</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- printing later.</span><span>
</span><span id="line-236"></span><span class="hs-comment">--</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- However, most of the time we need to filter our queries using</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- @WHERE@.  For example:</span><span>
</span><span id="line-239"></span><span class="hs-comment">--</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- SELECT *</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- FROM Person</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- WHERE Person.name = \&quot;John\&quot;</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- In @esqueleto@, we may write the same query above as:</span><span>
</span><span id="line-247"></span><span class="hs-comment">--</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- 'select' $</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- 'from' $ \\p -&gt; do</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- 'where_' (p '^.' PersonName '==.' 'val' \&quot;John\&quot;)</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- return p</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-254"></span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- Although @esqueleto@'s code is a bit more noisy, it's has</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- almost the same structure (save from the @return@).  The</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- @('^.')@ operator is used to project a field from an entity.</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- The field name is the same one generated by @persistent@'s</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- Template Haskell functions.  We use 'val' to lift a constant</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- Haskell value into the SQL query.</span><span>
</span><span id="line-261"></span><span class="hs-comment">--</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- Another example would be:</span><span>
</span><span id="line-263"></span><span class="hs-comment">--</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- SELECT *</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- FROM Person</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- WHERE Person.age &gt;= 18</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-269"></span><span class="hs-comment">--</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- In @esqueleto@, we may write the same query above as:</span><span>
</span><span id="line-271"></span><span class="hs-comment">--</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- 'select' $</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- 'from' $ \\p -&gt; do</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- 'where_' (p '^.' PersonAge '&gt;=.' 'just' ('val' 18))</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- return p</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-278"></span><span class="hs-comment">--</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- Since @age@ is an optional @Person@ field, we use 'just' to lift</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- @'val' 18 :: SqlExpr (Value Int)@ into @just ('val' 18) ::</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- SqlExpr (Value (Maybe Int))@.</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- Implicit joins are represented by tuples.  For example, to get</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- the list of all blog posts and their authors, we could write:</span><span>
</span><span id="line-285"></span><span class="hs-comment">--</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- SELECT BlogPost.*, Person.*</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- FROM BlogPost, Person</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- WHERE BlogPost.authorId = Person.id</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- ORDER BY BlogPost.title ASC</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-292"></span><span class="hs-comment">--</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- In @esqueleto@, we may write the same query above as:</span><span>
</span><span id="line-294"></span><span class="hs-comment">--</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- 'select' $</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- 'from' $ \\(b, p) -&gt; do</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- 'where_' (b '^.' BlogPostAuthorId '==.' p '^.' PersonId)</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- 'orderBy' ['asc' (b '^.' BlogPostTitle)]</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- return (b, p)</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-302"></span><span class="hs-comment">--</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- However, you may want your results to include people who don't</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- have any blog posts as well using a @LEFT OUTER JOIN@:</span><span>
</span><span id="line-305"></span><span class="hs-comment">--</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- SELECT Person.*, BlogPost.*</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- FROM Person LEFT OUTER JOIN BlogPost</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- ON Person.id = BlogPost.authorId</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- ORDER BY Person.name ASC, BlogPost.title ASC</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-312"></span><span class="hs-comment">--</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- In @esqueleto@, we may write the same query above as:</span><span>
</span><span id="line-314"></span><span class="hs-comment">--</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- 'select' $</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- 'from' $ \\(p `'LeftOuterJoin`` mb) -&gt; do</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- 'on' ('just' (p '^.' PersonId) '==.' mb '?.' BlogPostAuthorId)</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- 'orderBy' ['asc' (p '^.' PersonName), 'asc' (mb '?.' BlogPostTitle)]</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- return (p, mb)</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-322"></span><span class="hs-comment">--</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- On a @LEFT OUTER JOIN@ the entity on the right hand side may</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- not exist (i.e. there may be a @Person@ without any</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- @BlogPost@s), so while @p :: SqlExpr (Entity Person)@, we have</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- @mb :: SqlExpr (Maybe (Entity BlogPost))@.  The whole</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- expression above has type @SqlPersist m [(Entity Person, Maybe</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- (Entity BlogPost))]@.  Instead of using @(^.)@, we used</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- @('?.')@ to project a field from a @Maybe (Entity a)@.</span><span>
</span><span id="line-330"></span><span class="hs-comment">--</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- We are by no means limited to joins of two tables, nor by</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- joins of different tables.  For example, we may want a list</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- of the @Follow@ entity:</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- SELECT P1.*, Follow.*, P2.*</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- FROM Person AS P1</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- INNER JOIN Follow ON P1.id = Follow.follower</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- INNER JOIN Person AS P2 ON P2.id = Follow.followed</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-341"></span><span class="hs-comment">--</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- In @esqueleto@, we may write the same query above as:</span><span>
</span><span id="line-343"></span><span class="hs-comment">--</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- 'select' $</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- 'from' $ \\(p1 `'InnerJoin`` f `'InnerJoin`` p2) -&gt; do</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- 'on' (p1 '^.' PersonId '==.' f '^.' FollowFollower)</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- 'on' (p2 '^.' PersonId '==.' f '^.' FollowFollowed)</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- return (p1, f, p2)</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-351"></span><span class="hs-comment">--</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- We also currently support @UPDATE@ and @DELETE@ statements.</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-354"></span><span class="hs-comment">--</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- do 'update' $ \\p -&gt; do</span><span>
</span><span id="line-357"></span><span class="hs-comment">--      'set' p [ PersonName '=.' 'val' \&quot;Jo&#227;o\&quot; ]</span><span>
</span><span id="line-358"></span><span class="hs-comment">--      'where_' (p '^.' PersonName '==.' 'val' \&quot;Joao\&quot;)</span><span>
</span><span id="line-359"></span><span class="hs-comment">--    'delete' $</span><span>
</span><span id="line-360"></span><span class="hs-comment">--      'from' $ \\p -&gt; do</span><span>
</span><span id="line-361"></span><span class="hs-comment">--      'where_' (p '^.' PersonAge '&lt;.' 'just' ('val' 14))</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-363"></span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- The results of queries can also be used for insertions.</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- In @SQL@, we might write the following, inserting a new blog</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- post for every user:</span><span>
</span><span id="line-367"></span><span class="hs-comment">--</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- INSERT INTO BlogPost</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- SELECT ('Group Blog Post', id)</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- FROM Person</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-373"></span><span class="hs-comment">--</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- In @esqueleto@, we may write the same query above as:</span><span>
</span><span id="line-375"></span><span class="hs-comment">--</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-377"></span><span class="hs-comment">--  'insertSelect' $ 'from' $ \\p-&gt;</span><span>
</span><span id="line-378"></span><span class="hs-comment">--  return $ BlogPost '&lt;#' \&quot;Group Blog Post\&quot; '&lt;&amp;&gt;' (p '^.' PersonId)</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-380"></span><span class="hs-comment">--</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- Individual insertions can be performed through Persistent's</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- 'insert' function, reexported for convenience.</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- $reexports</span><span>
</span><span id="line-389"></span><span class="hs-comment">--</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- We re-export many symbols from @persistent@ for convenince:</span><span>
</span><span id="line-391"></span><span class="hs-comment">--</span><span>
</span><span id="line-392"></span><span class="hs-comment">--  * \&quot;Store functions\&quot; from &quot;Database.Persist&quot;.</span><span>
</span><span id="line-393"></span><span class="hs-comment">--</span><span>
</span><span id="line-394"></span><span class="hs-comment">--  * Everything from &quot;Database.Persist.Class&quot; except for</span><span>
</span><span id="line-395"></span><span class="hs-comment">--    @PersistQuery@ and @delete@ (use 'deleteKey' instead).</span><span>
</span><span id="line-396"></span><span class="hs-comment">--</span><span>
</span><span id="line-397"></span><span class="hs-comment">--  * Everything from &quot;Database.Persist.Types&quot; except for</span><span>
</span><span id="line-398"></span><span class="hs-comment">--    @Update@, @SelectOpt@, @BackendSpecificFilter@ and @Filter@.</span><span>
</span><span id="line-399"></span><span class="hs-comment">--</span><span>
</span><span id="line-400"></span><span class="hs-comment">--  * Everything from &quot;Database.Persist.Sql&quot; except for</span><span>
</span><span id="line-401"></span><span class="hs-comment">--    @deleteWhereCount@ and @updateWhereCount@.</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-comment">-- $rdbmsSpecificModules</span><span>
</span><span id="line-408"></span><span class="hs-comment">--</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- There are many differences between SQL syntax and functions</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- supported by different RDBMSs.  Since version 2.2.8,</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- @esqueleto@ includes modules containing functions that are</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- specific to a given RDBMS.</span><span>
</span><span id="line-413"></span><span class="hs-comment">--</span><span>
</span><span id="line-414"></span><span class="hs-comment">--  * PostgreSQL: &quot;Database.Esqueleto.PostgreSQL&quot;.</span><span>
</span><span id="line-415"></span><span class="hs-comment">--</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- In order to use these functions, you need to explicitly import</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- their corresponding modules, they're not re-exported here.</span><span>
</span><span id="line-418"></span></pre></body></html>