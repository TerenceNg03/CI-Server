<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | This module contains a new way (introduced in 3.3.3.0) of using @FROM@ in</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Haskell. The old method was a bit finicky and could permit runtime errors,</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- and this new way is both significantly safer and much more powerful.</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- This syntax will become the default syntax exported from the library in</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- version @3.6.0.0@. To use the old syntax, see &quot;Database.Esqueleto.Legacy&quot;.</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Esqueleto.Experimental</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Setup</span></span><span>
</span><span id="line-11"></span><span>      </span><span class="annot"><span class="hs-comment">-- $setup</span></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Introduction</span></span><span>
</span><span id="line-14"></span><span>      </span><span class="annot"><span class="hs-comment">-- $introduction</span></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>      </span><span class="annot"><span class="hs-comment">-- * A New Syntax</span></span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><span class="hs-comment">-- $new-syntax</span></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Documentation</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Basic Queries</span></span><span>
</span><span id="line-22"></span><span>      </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.html#from"><span class="hs-identifier">from</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.html#table"><span class="hs-identifier">table</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.html#Table"><span class="hs-identifier">Table</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.html#SubQuery"><span class="hs-identifier">SubQuery</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.html#selectQuery"><span class="hs-identifier">selectQuery</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Joins</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3A%26"><span class="hs-operator">(:&amp;)</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#on"><span class="hs-identifier">on</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#innerJoin"><span class="hs-identifier">innerJoin</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#innerJoinLateral"><span class="hs-identifier">innerJoinLateral</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#leftJoin"><span class="hs-identifier">leftJoin</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#leftJoinLateral"><span class="hs-identifier">leftJoinLateral</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#rightJoin"><span class="hs-identifier">rightJoin</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#fullOuterJoin"><span class="hs-identifier">fullOuterJoin</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#crossJoin"><span class="hs-identifier">crossJoin</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#crossJoinLateral"><span class="hs-identifier">crossJoinLateral</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Set Operations</span></span><span>
</span><span id="line-41"></span><span>      </span><span class="annot"><span class="hs-comment">-- $sql-set-operations</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html#union_"><span class="hs-identifier">union_</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html#Union"><span class="hs-identifier">Union</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html#unionAll_"><span class="hs-identifier">unionAll_</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html#UnionAll"><span class="hs-identifier">UnionAll</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html#except_"><span class="hs-identifier">except_</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html#Except"><span class="hs-identifier">Except</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html#intersect_"><span class="hs-identifier">intersect_</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html#Intersect"><span class="hs-identifier">Intersect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html#SelectQuery"><span class="hs-identifier">SelectQuery</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Common Table Expressions</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.CommonTableExpression.html#with"><span class="hs-identifier">with</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.CommonTableExpression.html#withRecursive"><span class="hs-identifier">withRecursive</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Internals</span></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.html#From"><span class="hs-identifier">From</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.ToMaybe.html#ToMaybe"><span class="hs-identifier">ToMaybe</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.ToAlias.html#ToAlias"><span class="hs-identifier">ToAlias</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.ToAlias.html#ToAliasT"><span class="hs-identifier">ToAliasT</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.ToAliasReference.html#ToAliasReference"><span class="hs-identifier">ToAliasReference</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.ToAliasReference.html#ToAliasReferenceT"><span class="hs-identifier">ToAliasReferenceT</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html#ToSqlSetOperation"><span class="hs-identifier">ToSqlSetOperation</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="hs-comment">-- * The Normal Stuff</span></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#where_"><span class="hs-identifier">where_</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#groupBy"><span class="hs-identifier">groupBy</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#groupBy_"><span class="hs-identifier">groupBy_</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#orderBy"><span class="hs-identifier">orderBy</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#rand"><span class="hs-identifier">rand</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#asc"><span class="hs-identifier">asc</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#desc"><span class="hs-identifier">desc</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#limit"><span class="hs-identifier">limit</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#offset"><span class="hs-identifier">offset</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#distinct"><span class="hs-identifier">distinct</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#distinctOn"><span class="hs-identifier">distinctOn</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#don"><span class="hs-identifier">don</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#distinctOnOrderBy"><span class="hs-identifier">distinctOnOrderBy</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#having"><span class="hs-identifier">having</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#locking"><span class="hs-identifier">locking</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#sub_select"><span class="hs-identifier">sub_select</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%5E."><span class="hs-operator">(^.)</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3F."><span class="hs-operator">(?.)</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#val"><span class="hs-identifier">val</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#isNothing"><span class="hs-identifier">isNothing</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#isNothing_"><span class="hs-identifier">isNothing_</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#just"><span class="hs-identifier">just</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#nothing"><span class="hs-identifier">nothing</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#joinV"><span class="hs-identifier">joinV</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#withNonNull"><span class="hs-identifier">withNonNull</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#countRows"><span class="hs-identifier">countRows</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#count"><span class="hs-identifier">count</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#countDistinct"><span class="hs-identifier">countDistinct</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#not_"><span class="hs-identifier">not_</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3D%3D."><span class="hs-operator">(==.)</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3E%3D."><span class="hs-operator">(&gt;=.)</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3E."><span class="hs-operator">(&gt;.)</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3C%3D."><span class="hs-operator">(&lt;=.)</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3C."><span class="hs-operator">(&lt;.)</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%21%3D."><span class="hs-operator">(!=.)</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%26%26."><span class="hs-operator">(&amp;&amp;.)</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%7C%7C."><span class="hs-operator">(||.)</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#between"><span class="hs-identifier">between</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2B."><span class="hs-operator">(+.)</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#-."><span class="hs-operator">(-.)</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2F."><span class="hs-operator">(/.)</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2A."><span class="hs-operator">(*.)</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#random_"><span class="hs-identifier">random_</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#round_"><span class="hs-identifier">round_</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#ceiling_"><span class="hs-identifier">ceiling_</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#floor_"><span class="hs-identifier">floor_</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#min_"><span class="hs-identifier">min_</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#max_"><span class="hs-identifier">max_</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#sum_"><span class="hs-identifier">sum_</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#avg_"><span class="hs-identifier">avg_</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#castNum"><span class="hs-identifier">castNum</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#castNumM"><span class="hs-identifier">castNumM</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#coalesce"><span class="hs-identifier">coalesce</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#coalesceDefault"><span class="hs-identifier">coalesceDefault</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#lower_"><span class="hs-identifier">lower_</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#upper_"><span class="hs-identifier">upper_</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#trim_"><span class="hs-identifier">trim_</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#ltrim_"><span class="hs-identifier">ltrim_</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#rtrim_"><span class="hs-identifier">rtrim_</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#length_"><span class="hs-identifier">length_</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#left_"><span class="hs-identifier">left_</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#right_"><span class="hs-identifier">right_</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#like"><span class="hs-identifier">like</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#ilike"><span class="hs-identifier">ilike</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%25"><span class="hs-operator">(%)</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#concat_"><span class="hs-identifier">concat_</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2B%2B."><span class="hs-operator">(++.)</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#castString"><span class="hs-identifier">castString</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subList_select"><span class="hs-identifier">subList_select</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#valList"><span class="hs-identifier">valList</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#justList"><span class="hs-identifier">justList</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#in_"><span class="hs-identifier">in_</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#notIn"><span class="hs-identifier">notIn</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#exists"><span class="hs-identifier">exists</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#notExists"><span class="hs-identifier">notExists</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#set"><span class="hs-identifier">set</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3D."><span class="hs-operator">(=.)</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2B%3D."><span class="hs-operator">(+=.)</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#-%3D."><span class="hs-operator">(-=.)</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2A%3D."><span class="hs-operator">(*=.)</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%2F%3D."><span class="hs-operator">(/=.)</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#case_"><span class="hs-identifier">case_</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#toBaseId"><span class="hs-identifier">toBaseId</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelect"><span class="hs-identifier">subSelect</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelectMaybe"><span class="hs-identifier">subSelectMaybe</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelectCount"><span class="hs-identifier">subSelectCount</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelectForeign"><span class="hs-identifier">subSelectForeign</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelectList"><span class="hs-identifier">subSelectList</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#subSelectUnsafe"><span class="hs-identifier">subSelectUnsafe</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#ToBaseId"><span class="hs-identifier">ToBaseId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#when_"><span class="hs-identifier">when_</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#then_"><span class="hs-identifier">then_</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#else_"><span class="hs-identifier">else_</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#ValueList"><span class="hs-identifier">ValueList</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#OrderBy"><span class="hs-identifier">OrderBy</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#DistinctOn"><span class="hs-identifier">DistinctOn</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#LockingKind"><span class="hs-identifier">LockingKind</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#LockableEntity"><span class="hs-identifier">LockableEntity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#SqlString"><span class="hs-identifier">SqlString</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Joins</span></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#InnerJoin"><span class="hs-identifier">InnerJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#CrossJoin"><span class="hs-identifier">CrossJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#LeftOuterJoin"><span class="hs-identifier">LeftOuterJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#RightOuterJoin"><span class="hs-identifier">RightOuterJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#FullOuterJoin"><span class="hs-identifier">FullOuterJoin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#JoinKind"><span class="hs-identifier">JoinKind</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#OnClauseWithoutMatchingJoinException"><span class="hs-identifier">OnClauseWithoutMatchingJoinException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><span class="hs-comment">-- *** Join Helpers</span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#getTable"><span class="hs-identifier">getTable</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#getTableMaybe"><span class="hs-identifier">getTableMaybe</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html#GetFirstTable"><span class="hs-identifier">GetFirstTable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** SQL backend</span></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#SqlQuery"><span class="hs-identifier">SqlQuery</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#SqlExpr"><span class="hs-identifier">SqlExpr</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#SqlEntity"><span class="hs-identifier">SqlEntity</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#select"><span class="hs-identifier">select</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#selectOne"><span class="hs-identifier">selectOne</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#selectSource"><span class="hs-identifier">selectSource</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#delete"><span class="hs-identifier">delete</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#deleteCount"><span class="hs-identifier">deleteCount</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#update"><span class="hs-identifier">update</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#updateCount"><span class="hs-identifier">updateCount</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#insertSelect"><span class="hs-identifier">insertSelect</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#insertSelectCount"><span class="hs-identifier">insertSelectCount</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3C%23"><span class="hs-operator">(&lt;#)</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#%3C%26%3E"><span class="hs-operator">(&lt;&amp;&gt;)</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Rendering Queries</span></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#renderQueryToText"><span class="hs-identifier">renderQueryToText</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#renderQuerySelect"><span class="hs-identifier">renderQuerySelect</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#renderQueryUpdate"><span class="hs-identifier">renderQueryUpdate</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#renderQueryDelete"><span class="hs-identifier">renderQueryDelete</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#renderQueryInsertInto"><span class="hs-identifier">renderQueryInsertInto</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Helpers</span></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#valkey"><span class="hs-identifier">valkey</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#valJ"><span class="hs-identifier">valJ</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#associateJoin"><span class="hs-identifier">associateJoin</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Re-exports</span></span><span>
</span><span id="line-224"></span><span>      </span><span class="annot"><span class="hs-comment">-- $reexports</span></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#deleteKey"><span class="hs-identifier">deleteKey</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.PersistentImport.html"><span class="hs-identifier">Database.Esqueleto.Internal.PersistentImport</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html"><span class="hs-identifier">Database.Esqueleto.Internal.Internal</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#From"><span class="hs-identifier">From</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#from"><span class="hs-identifier">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.Internal.html#on"><span class="hs-identifier">on</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Internal.PersistentImport.html"><span class="hs-identifier">Database.Esqueleto.Internal.PersistentImport</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.html"><span class="hs-identifier">Database.Esqueleto.Experimental.From</span></a></span><span>
</span><span id="line-233"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.CommonTableExpression.html"><span class="hs-identifier">Database.Esqueleto.Experimental.From.CommonTableExpression</span></a></span><span>
</span><span id="line-234"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.Join.html"><span class="hs-identifier">Database.Esqueleto.Experimental.From.Join</span></a></span><span>
</span><span id="line-235"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.From.SqlSetOperation.html"><span class="hs-identifier">Database.Esqueleto.Experimental.From.SqlSetOperation</span></a></span><span>
</span><span id="line-236"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.ToAlias.html"><span class="hs-identifier">Database.Esqueleto.Experimental.ToAlias</span></a></span><span>
</span><span id="line-237"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.ToAliasReference.html"><span class="hs-identifier">Database.Esqueleto.Experimental.ToAliasReference</span></a></span><span>
</span><span id="line-238"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Esqueleto.Experimental.ToMaybe.html"><span class="hs-identifier">Database.Esqueleto.Experimental.ToMaybe</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-241"></span><span class="hs-comment">--</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- If you're already using &quot;Database.Esqueleto&quot;, then you can get</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- started using this module just by changing your imports slightly,</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- as well as enabling the [TypeApplications](https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-TypeApplications) extension.</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- {-\# LANGUAGE TypeApplications \#-}</span><span>
</span><span id="line-248"></span><span class="hs-comment">--</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- ...</span><span>
</span><span id="line-250"></span><span class="hs-comment">--</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- import Database.Esqueleto.Experimental</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-253"></span><span class="hs-comment">--</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- Note: Prior to @esqueleto-3.3.4.0@, the @Database.Esqueleto.Experimental@</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- module did not reexport @Data.Esqueleto@.</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">-- $introduction</span><span>
</span><span id="line-260"></span><span class="hs-comment">--</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- This module is fully backwards-compatible extension to the @esqueleto@</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- EDSL that expands subquery functionality and enables</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- [SQL set operations](https://en.wikipedia.org/wiki/Set_operations_(SQL\))</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- to be written directly in Haskell. Specifically, this enables:</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="hs-comment">--   * Subqueries in 'JOIN' statements</span><span>
</span><span id="line-267"></span><span class="hs-comment">--   * 'UNION'</span><span>
</span><span id="line-268"></span><span class="hs-comment">--   * 'UNION' 'ALL'</span><span>
</span><span id="line-269"></span><span class="hs-comment">--   * 'INTERSECT'</span><span>
</span><span id="line-270"></span><span class="hs-comment">--   * 'EXCEPT'</span><span>
</span><span id="line-271"></span><span class="hs-comment">--</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- As a consequence of this, several classes of runtime errors are now</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- caught at compile time. This includes missing 'on' clauses and improper</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- handling of @Maybe@ values in outer joins.</span><span>
</span><span id="line-275"></span><span class="hs-comment">--</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- This module can be used in conjunction with the main &quot;Database.Esqueleto&quot;</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- module, but doing so requires qualified imports to avoid ambiguous</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- definitions of 'on' and 'from', which are defined in both modules.</span><span>
</span><span id="line-279"></span><span class="hs-comment">--</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- Below we will give an overview of how to use this module and the</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- features it enables.</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- $new-syntax</span><span>
</span><span id="line-286"></span><span class="hs-comment">--</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- This module introduces a new syntax that serves to enable the aforementioned</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- features. This new syntax also changes how joins written in the @esqueleto@</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- EDSL to more closely resemble the underlying SQL.</span><span>
</span><span id="line-290"></span><span class="hs-comment">--</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- For our examples, we'll use a schema similar to the one in the Getting Started</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- section of &quot;Database.Esqueleto&quot;:</span><span>
</span><span id="line-293"></span><span class="hs-comment">--</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- share [mkPersist sqlSettings, mkMigrate &quot;migrateAll&quot;] [persist|</span><span>
</span><span id="line-296"></span><span class="hs-comment">--   Person</span><span>
</span><span id="line-297"></span><span class="hs-comment">--     name String</span><span>
</span><span id="line-298"></span><span class="hs-comment">--     age Int Maybe</span><span>
</span><span id="line-299"></span><span class="hs-comment">--     deriving Eq Show</span><span>
</span><span id="line-300"></span><span class="hs-comment">--   BlogPost</span><span>
</span><span id="line-301"></span><span class="hs-comment">--     title String</span><span>
</span><span id="line-302"></span><span class="hs-comment">--     authorId PersonId</span><span>
</span><span id="line-303"></span><span class="hs-comment">--     deriving Eq Show</span><span>
</span><span id="line-304"></span><span class="hs-comment">--   Follow</span><span>
</span><span id="line-305"></span><span class="hs-comment">--     follower PersonId</span><span>
</span><span id="line-306"></span><span class="hs-comment">--     followed PersonId</span><span>
</span><span id="line-307"></span><span class="hs-comment">--     deriving Eq Show</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- |]</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-310"></span><span class="hs-comment">--</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- === Example 1: Simple select</span><span>
</span><span id="line-312"></span><span class="hs-comment">--</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- Let's select all people who are named \&quot;John\&quot;.</span><span>
</span><span id="line-314"></span><span class="hs-comment">--</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- ==== &quot;Database.Esqueleto&quot;:</span><span>
</span><span id="line-316"></span><span class="hs-comment">--</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- select $</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- from $ \\people -&gt; do</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- where_ (people ^. PersonName ==. val \&quot;John\&quot;)</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- pure people</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-323"></span><span class="hs-comment">--</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- ==== &quot;Database.Esqueleto.Experimental&quot;:</span><span>
</span><span id="line-325"></span><span class="hs-comment">--</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- select $ do</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- people &lt;- from $ table \@Person</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- where_ (people ^. PersonName ==. val \&quot;John\&quot;)</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- pure people</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-332"></span><span class="hs-comment">--</span><span>
</span><span id="line-333"></span><span class="hs-comment">--</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- === Example 2: Select with join</span><span>
</span><span id="line-335"></span><span class="hs-comment">--</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- Let's select all people and their blog posts who are over</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- the age of 18.</span><span>
</span><span id="line-338"></span><span class="hs-comment">--</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- ==== &quot;Database.Esqueleto&quot;:</span><span>
</span><span id="line-340"></span><span class="hs-comment">--</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- select $</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- from $ \\(people \`LeftOuterJoin\` blogPosts) -&gt; do</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- on (just (people ^. PersonId) ==. blogPosts ?. BlogPostAuthorId)</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- where_ (people ^. PersonAge &gt;. just (val 18))</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- pure (people, blogPosts)</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-348"></span><span class="hs-comment">--</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- ==== &quot;Database.Esqueleto.Experimental&quot;:</span><span>
</span><span id="line-350"></span><span class="hs-comment">--</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- Here we use the ':&amp;' operator to pattern match against the joined tables.</span><span>
</span><span id="line-352"></span><span class="hs-comment">--</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- select $ do</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- (people :&amp; blogPosts) &lt;-</span><span>
</span><span id="line-356"></span><span class="hs-comment">--     from $ table \@Person</span><span>
</span><span id="line-357"></span><span class="hs-comment">--     \`leftJoin\` table \@BlogPost</span><span>
</span><span id="line-358"></span><span class="hs-comment">--     \`on\` (\\(people :&amp; blogPosts) -&gt;</span><span>
</span><span id="line-359"></span><span class="hs-comment">--             just (people ^. PersonId) ==. blogPosts ?. BlogPostAuthorId)</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- where_ (people ^. PersonAge &gt;. just (val 18))</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- pure (people, blogPosts)</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-363"></span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- === Example 3: Select with multi-table join</span><span>
</span><span id="line-365"></span><span class="hs-comment">--</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- Let's select all people who follow a person named \&quot;John\&quot;, including</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- the name of each follower.</span><span>
</span><span id="line-368"></span><span class="hs-comment">--</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- ==== &quot;Database.Esqueleto&quot;:</span><span>
</span><span id="line-370"></span><span class="hs-comment">--</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- select $</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- from $ \\(</span><span>
</span><span id="line-374"></span><span class="hs-comment">--  people1</span><span>
</span><span id="line-375"></span><span class="hs-comment">--  \`InnerJoin\` followers</span><span>
</span><span id="line-376"></span><span class="hs-comment">--  \`InnerJoin\` people2</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- ) -&gt; do</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- on (people1 ^. PersonId ==. followers ^. FollowFollowed)</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- on (followers ^. FollowFollower ==. people2 ^. PersonId)</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- where_ (people1 ^. PersonName ==. val \&quot;John\&quot;)</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- pure (followers, people2)</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-383"></span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- ==== &quot;Database.Esqueleto.Experimental&quot;:</span><span>
</span><span id="line-385"></span><span class="hs-comment">--</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- In this version, with each successive 'on' clause, only the tables</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- we have already joined into are in scope, so we must pattern match</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- accordingly. In this case, in the second 'innerJoin', we do not use</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- the first `Person` reference, so we use @_@ as a placeholder to</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- ignore it. This prevents a possible runtime error where a table</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- is referenced before it appears in the sequence of 'JOIN's.</span><span>
</span><span id="line-392"></span><span class="hs-comment">--</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- select $ do</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- (people1 :&amp; followers :&amp; people2) &lt;-</span><span>
</span><span id="line-396"></span><span class="hs-comment">--     from $ table \@Person</span><span>
</span><span id="line-397"></span><span class="hs-comment">--     \`innerJoin` table \@Follow</span><span>
</span><span id="line-398"></span><span class="hs-comment">--     \`on\` (\\(people1 :&amp; followers) -&gt;</span><span>
</span><span id="line-399"></span><span class="hs-comment">--             people1 ^. PersonId ==. followers ^. FollowFollowed)</span><span>
</span><span id="line-400"></span><span class="hs-comment">--     \`innerJoin` table \@Person</span><span>
</span><span id="line-401"></span><span class="hs-comment">--     \`on\` (\\(_ :&amp; followers :&amp; people2) -&gt;</span><span>
</span><span id="line-402"></span><span class="hs-comment">--             followers ^. FollowFollower ==. people2 ^. PersonId)</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- where_ (people1 ^. PersonName ==. val \&quot;John\&quot;)</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- pure (followers, people2)</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-406"></span><span class="hs-comment">--</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- === Example 4: Counting results of a subquery</span><span>
</span><span id="line-408"></span><span class="hs-comment">--</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- Let's count the number of people who have posted at least 10 posts</span><span>
</span><span id="line-410"></span><span class="hs-comment">--</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- ==== &quot;Database.Esqueleto&quot;:</span><span>
</span><span id="line-412"></span><span class="hs-comment">--</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- select $ pure $ subSelectCount $</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- from $ \\(</span><span>
</span><span id="line-416"></span><span class="hs-comment">--   people</span><span>
</span><span id="line-417"></span><span class="hs-comment">--   \`InnerJoin\` blogPosts</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- ) -&gt; do</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- on (people ^. PersonId ==. blogPosts ^. BlogPostAuthorId)</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- groupBy (people ^. PersonId)</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- having ((count $ blogPosts ^. BlogPostId) &gt;. val 10)</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- pure people</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-424"></span><span class="hs-comment">--</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- ==== &quot;Database.Esqueleto.Experimental&quot;:</span><span>
</span><span id="line-426"></span><span class="hs-comment">--</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- select $ do</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- peopleWithPosts &lt;-</span><span>
</span><span id="line-430"></span><span class="hs-comment">--   from $ do</span><span>
</span><span id="line-431"></span><span class="hs-comment">--     (people :&amp; blogPosts) &lt;-</span><span>
</span><span id="line-432"></span><span class="hs-comment">--       from $ table \@Person</span><span>
</span><span id="line-433"></span><span class="hs-comment">--       \`innerJoin\` table \@BlogPost</span><span>
</span><span id="line-434"></span><span class="hs-comment">--       \`on\` (\\(p :&amp; bP) -&gt;</span><span>
</span><span id="line-435"></span><span class="hs-comment">--               p ^. PersonId ==. bP ^. BlogPostAuthorId)</span><span>
</span><span id="line-436"></span><span class="hs-comment">--     groupBy (people ^. PersonId)</span><span>
</span><span id="line-437"></span><span class="hs-comment">--     having ((count $ blogPosts ^. BlogPostId) &gt;. val 10)</span><span>
</span><span id="line-438"></span><span class="hs-comment">--     pure people</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- pure $ count (peopleWithPosts ^. PersonId)</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-441"></span><span class="hs-comment">--</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- We now have the ability to refactor this</span><span>
</span><span id="line-443"></span><span class="hs-comment">--</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- === Example 5: Sorting the results of a UNION with limits</span><span>
</span><span id="line-445"></span><span class="hs-comment">--</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- Out of all of the posts created by a person and the people they follow,</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- generate a list of the first 25 posts, sorted alphabetically.</span><span>
</span><span id="line-448"></span><span class="hs-comment">--</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- ==== &quot;Database.Esqueleto&quot;:</span><span>
</span><span id="line-450"></span><span class="hs-comment">--</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- Since 'UNION' is not supported, this requires using `Database.Esqueleto.rawSql`. (Not shown)</span><span>
</span><span id="line-452"></span><span class="hs-comment">--</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- ==== &quot;Database.Esqueleto.Experimental&quot;:</span><span>
</span><span id="line-454"></span><span class="hs-comment">--</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- Since this module supports all set operations (see `SqlSetOperation`), we can use</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- `Union` to write this query.</span><span>
</span><span id="line-457"></span><span class="hs-comment">--</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- select $ do</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- (authors, blogPosts) &lt;- from $</span><span>
</span><span id="line-461"></span><span class="hs-comment">--   (do</span><span>
</span><span id="line-462"></span><span class="hs-comment">--     (author :&amp; blogPost) &lt;-</span><span>
</span><span id="line-463"></span><span class="hs-comment">--       from $ table \@Person</span><span>
</span><span id="line-464"></span><span class="hs-comment">--       \`innerJoin\` table \@BlogPost</span><span>
</span><span id="line-465"></span><span class="hs-comment">--       \`on\` (\\(a :&amp; bP) -&gt;</span><span>
</span><span id="line-466"></span><span class="hs-comment">--               a ^. PersonId ==. bP ^. BlogPostAuthorId)</span><span>
</span><span id="line-467"></span><span class="hs-comment">--     where_ (author ^. PersonId ==. val currentPersonId)</span><span>
</span><span id="line-468"></span><span class="hs-comment">--     pure (author, blogPost)</span><span>
</span><span id="line-469"></span><span class="hs-comment">--   )</span><span>
</span><span id="line-470"></span><span class="hs-comment">--   \`union_\`</span><span>
</span><span id="line-471"></span><span class="hs-comment">--   (do</span><span>
</span><span id="line-472"></span><span class="hs-comment">--     (follow :&amp; blogPost :&amp; author) &lt;-</span><span>
</span><span id="line-473"></span><span class="hs-comment">--       from $ table \@Follow</span><span>
</span><span id="line-474"></span><span class="hs-comment">--       \`innerJoin\` table \@BlogPost</span><span>
</span><span id="line-475"></span><span class="hs-comment">--       \`on\` (\\(f :&amp; bP) -&gt;</span><span>
</span><span id="line-476"></span><span class="hs-comment">--               f ^. FollowFollowed ==. bP ^. BlogPostAuthorId)</span><span>
</span><span id="line-477"></span><span class="hs-comment">--       \`innerJoin\` table \@Person</span><span>
</span><span id="line-478"></span><span class="hs-comment">--       \`on\` (\\(_ :&amp; bP :&amp; a) -&gt;</span><span>
</span><span id="line-479"></span><span class="hs-comment">--               bP ^. BlogPostAuthorId ==. a ^. PersonId)</span><span>
</span><span id="line-480"></span><span class="hs-comment">--     where_ (follow ^. FollowFollower ==. val currentPersonId)</span><span>
</span><span id="line-481"></span><span class="hs-comment">--     pure (author, blogPost)</span><span>
</span><span id="line-482"></span><span class="hs-comment">--   )</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- orderBy [ asc (blogPosts ^. BlogPostTitle) ]</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- limit 25</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- pure (authors, blogPosts)</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-487"></span><span class="hs-comment">--</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- === Example 6: LATERAL JOIN</span><span>
</span><span id="line-489"></span><span class="hs-comment">--</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- As of version @3.4.0.0@, lateral subquery joins are supported.</span><span>
</span><span id="line-491"></span><span class="hs-comment">--</span><span>
</span><span id="line-492"></span><span class="hs-comment">--</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- select $ do</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- (salesPerson :&amp; maxSaleAmount :&amp; maxSaleCustomerName) &lt;-</span><span>
</span><span id="line-496"></span><span class="hs-comment">--   from $ table \@SalesPerson</span><span>
</span><span id="line-497"></span><span class="hs-comment">--   \`crossJoinLateral\` (\\salesPerson -&gt; do</span><span>
</span><span id="line-498"></span><span class="hs-comment">--         sales &lt;- from $ table \@Sale</span><span>
</span><span id="line-499"></span><span class="hs-comment">--         where_ $ sales ^. SaleSalesPersonId ==. salesPerson ^. SalesPersonId</span><span>
</span><span id="line-500"></span><span class="hs-comment">--         pure $ max_ (sales ^. SaleAmount)</span><span>
</span><span id="line-501"></span><span class="hs-comment">--         )</span><span>
</span><span id="line-502"></span><span class="hs-comment">--   \`crossJoinLateral\` (\\(salesPerson :&amp; maxSaleAmount) -&gt; do</span><span>
</span><span id="line-503"></span><span class="hs-comment">--         sales &lt;- from $ table \@Sale</span><span>
</span><span id="line-504"></span><span class="hs-comment">--         where_ $ sales ^. SaleSalesPersonId ==. salesPerson ^. SalesPersonId</span><span>
</span><span id="line-505"></span><span class="hs-comment">--              &amp;&amp;. sales ^. SaleAmount ==. maxSaleAmount</span><span>
</span><span id="line-506"></span><span class="hs-comment">--         pure $ sales ^. SaleCustomerName)</span><span>
</span><span id="line-507"></span><span class="hs-comment">--         )</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- pure (salesPerson ^. SalesPersonName, maxSaleAmount, maxSaleCustomerName)</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-510"></span><span class="hs-comment">--</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- This is the equivalent to the following SQL (example taken from the</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- [MySQL Lateral Derived Table](https://dev.mysql.com/doc/refman/8.0/en/lateral-derived-tables.html)</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- documentation):</span><span>
</span><span id="line-514"></span><span class="hs-comment">--</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- SELECT</span><span>
</span><span id="line-517"></span><span class="hs-comment">--   salesperson.name,</span><span>
</span><span id="line-518"></span><span class="hs-comment">--   max_sale.amount,</span><span>
</span><span id="line-519"></span><span class="hs-comment">--   max_sale_customer.customer_name</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- FROM</span><span>
</span><span id="line-521"></span><span class="hs-comment">--   salesperson,</span><span>
</span><span id="line-522"></span><span class="hs-comment">--   -- calculate maximum size, cache it in transient derived table max_sale</span><span>
</span><span id="line-523"></span><span class="hs-comment">--   LATERAL</span><span>
</span><span id="line-524"></span><span class="hs-comment">--   (SELECT MAX(amount) AS amount</span><span>
</span><span id="line-525"></span><span class="hs-comment">--     FROM all_sales</span><span>
</span><span id="line-526"></span><span class="hs-comment">--     WHERE all_sales.salesperson_id = salesperson.id)</span><span>
</span><span id="line-527"></span><span class="hs-comment">--   AS max_sale,</span><span>
</span><span id="line-528"></span><span class="hs-comment">--   LATERAL</span><span>
</span><span id="line-529"></span><span class="hs-comment">--   (SELECT customer_name</span><span>
</span><span id="line-530"></span><span class="hs-comment">--     FROM all_sales</span><span>
</span><span id="line-531"></span><span class="hs-comment">--     WHERE all_sales.salesperson_id = salesperson.id</span><span>
</span><span id="line-532"></span><span class="hs-comment">--     AND all_sales.amount =</span><span>
</span><span id="line-533"></span><span class="hs-comment">--         -- the cached maximum size</span><span>
</span><span id="line-534"></span><span class="hs-comment">--         max_sale.amount)</span><span>
</span><span id="line-535"></span><span class="hs-comment">--   AS max_sale_customer;</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="hs-comment">-- $sql-set-operations</span><span>
</span><span id="line-539"></span><span class="hs-comment">--</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- Data type that represents SQL set operations. This includes</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- 'UNION', 'UNION' 'ALL', 'EXCEPT', and 'INTERSECT'. These types form</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- a binary tree, with @SqlQuery@ values on the leaves.</span><span>
</span><span id="line-543"></span><span class="hs-comment">--</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- Each function corresponding to the aforementioned set operations</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- can be used as an infix in a @from@ to help with readability</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- and lead to code that closely resembles the underlying SQL. For example,</span><span>
</span><span id="line-547"></span><span class="hs-comment">--</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- select $ from $</span><span>
</span><span id="line-550"></span><span class="hs-comment">--   (do</span><span>
</span><span id="line-551"></span><span class="hs-comment">--      a &lt;- from $ table @A</span><span>
</span><span id="line-552"></span><span class="hs-comment">--      pure $ a ^. ASomeCol</span><span>
</span><span id="line-553"></span><span class="hs-comment">--   )</span><span>
</span><span id="line-554"></span><span class="hs-comment">--   \`union_\`</span><span>
</span><span id="line-555"></span><span class="hs-comment">--   (do</span><span>
</span><span id="line-556"></span><span class="hs-comment">--      b &lt;- from $ table @B</span><span>
</span><span id="line-557"></span><span class="hs-comment">--      pure $ b ^. BSomeCol</span><span>
</span><span id="line-558"></span><span class="hs-comment">--   )</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-560"></span><span class="hs-comment">--</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- is translated into</span><span>
</span><span id="line-562"></span><span class="hs-comment">--</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- SELECT * FROM (</span><span>
</span><span id="line-565"></span><span class="hs-comment">--   (SELECT a.some_col FROM a)</span><span>
</span><span id="line-566"></span><span class="hs-comment">--   UNION</span><span>
</span><span id="line-567"></span><span class="hs-comment">--   (SELECT b.some_col FROM b)</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- )</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-570"></span><span class="hs-comment">--</span><span>
</span><span id="line-571"></span></pre></body></html>